<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تتبع التكاسي </title>
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
        }
        
        #map {
            width: 100%;
            height: 100vh;
        }
        
        .control-panel {
            position: absolute;
            top: 10px;
            right: 5px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            min-width: 320px;
            max-width: 350px;
            z-index: 1000;
            direction: rtl;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .control-panel h3 {
            color: #50312c;
            margin-bottom: 15px;
            border-bottom: 2px solid #e78700;
            padding-bottom: 8px;
            text-align: center;
        }
        
        .taxi-info {
            margin: 8px 0;
            padding: 12px;
            background: #ecf0f1;
            border-radius: 8px;
            border-right: 4px solid #f39c12;
            transition: all 0.3s ease;
        }
        
        .nearest-taxi {
            border-right-color: #27ae60 !important;
            background: #d5f4e6 !important;
            transform: scale(1.02);
        }
        
        .taxi-moving {
            border-right-color: #e74c3c !important;
            background: #ffeaa7 !important;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            margin: 8px 0;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .btn.success {
            background: #27ae60;
        }
        
        .btn.success:hover {
            background: #229954;
        }
        
        .status {
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-size: 13px;
        }
        
        .status.success {
            background: #d5f4e6;
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        
        .status.loading {
            background: #fef5e7;
            color: #f39c12;
            border: 1px solid #f39c12;
        }
        
        .status.error {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid #f39c12;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-left: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .mapboxgl-popup-content {
            direction: rtl;
            text-align: right;
        }
        
        .taxi-controls {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .taxi-controls button {
            flex: 1;
            padding: 6px 10px;
            font-size: 12px;
            margin: 0;
        }
        
        .route-info {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .eta-info {
            background: #e8f8f5;
            color: #27ae60;
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-top: 5px;
            font-weight: bold;
        }
        /* ==================== تحسينات الهاتف ==================== */
/* للهواتف الصغيرة */
@media (max-width: 480px) {
    .control-panel {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        top: auto;
        min-width: 100%;
        max-width: 100%;
        border-radius: 20px 20px 0 0;
        max-height: 70vh;
        padding: 15px;
        transform: translateY(calc(100% - 80px));
        transition: transform 0.3s ease;
    }
    
    .control-panel.expanded {
        transform: translateY(0);
    }
    
    .control-panel h3 {
        text-align: center;
        cursor: pointer;
        padding: 10px;
        margin: -15px -15px 15px -15px;
        background: #f8f9fa;
        border-radius: 20px 20px 0 0;
        position: relative;
    }
    
   .control-panel h3:after {
    content: "▲";
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 16px;
    color: #666;
    transition: transform 0.3s ease;
}
    
    .control-panel.expanded h3:after {
        transform: translate(-50%, -50%) rotate(180deg);
    }
    
    .btn {
        padding: 15px 20px;
        font-size: 16px;
        margin: 10px 0;
        min-height: 48px;
    }
    
    .taxi-info {
        padding: 15px;
        margin: 12px 0;
        font-size: 14px;
    }
    
    .taxi-controls button {
        padding: 12px 15px;
        font-size: 14px;
        min-height: 44px;
    }
    
    
}
    </style>
</head>
<body>
    <div id="map"></div>
    
    <!-- زر الطوارئ للهاتف -->
<button class="emergency-btn" onclick="emergencyCall()" style="display: none;">🚨</button>

<div class="control-panel" id="controlPanel">
    <h3 onclick="togglePanel()">  خدمة حجز تكاسي بيرزيت</h3>
        
        <button class="btn" onclick="findMyLocation()"> تحديد موقعي</button>
        <button class="btn" onclick="findNearestTaxi()" id="nearestBtn" disabled>العثور على أقرب تكسي</button>
        <button class="btn" onclick="callNearestTaxi()" id="callBtn" disabled> استدعاء أقرب تكسي</button>
        <button class="btn" onclick="startPatrolMode()">تشغيل حركة التكاسي</button>
        <button class="btn" onclick="stopAllTaxis()"> إيقاف جميع التكاسي</button>
        
        <div id="status"></div>
        
        <div id="taxiList">
            <h4 style="margin-top: 15px; color: #ef0206;">التكاسي المتاحة:</h4>
        </div>
    </div>

    <script>
        // إعداد Mapbox - ضع هنا مفتاح API الخاص بك
        mapboxgl.accessToken = 'pk.eyJ1IjoibW9oYW1tZWQtMTMzMSIsImEiOiJjbHY3dHFsaDcwZWcyMm9xaXBmdHVibm11In0.BDSWP06iKFsCOxq0IwxLBg';
        
        // إحداثيات رام الله كمركز للخريطة
        const ramallahCenter = [35.1916590, 31.9740321];
const birzeitBoundary = {
    "type": "FeatureCollection", 
    "features": [{
        "type": "Feature",
        "geometry": {
            "type": "Polygon",
            "coordinates": [[[35.193040389264226,31.99452197792411,0],[35.19305768812167,31.99468153871226,0],[35.19306312472577,31.994827097044134,0],[35.193091804339495,31.99522910934134,0],[35.1931354319196,31.995406480255923,0],[35.19318223594254,31.995646062817936,0],[35.19302547273892,31.99576342280171,0],[35.19284507665683,31.99580638426165,0],[35.192556297039076,31.995838199849207,0],[35.19238869296662,31.99571083991593,0],[35.19232958471924,31.995616515194154,0],[35.19229454862654,31.995560605218934,0],[35.19249052958051,31.995440272227437,0],[35.192524755392824,31.995223563042583,0],[35.192540018667806,31.995165806091972,0],[35.19256429114678,31.995073956078144,0],[35.192574190581226,31.994921037840196,0],[35.19254428297046,31.994776569876183,0],[35.192562031883845,31.99464078764049,0],[35.1925911157395,31.994473023068096,0],[35.192599857245526,31.994389193997094,0],[35.19261056785866,31.9942864630544,0],[35.19265250121613,31.994138340194663,0],[35.192700883579,31.993977464245035,0],[35.19250408605644,31.993986355966317,0],[35.192426100611684,31.993978459240182,0],[35.19226628583107,31.993962274949265,0],[35.1922121147245,31.994105150377464,0],[35.19199597377894,31.99410470392542,0],[35.19176543912755,31.993984099323573,0],[35.191479369727034,31.993891052759544,0],[35.191284671567296,31.993802244362076,0],[35.19105039902602,31.993674767321412,0],[35.190863508124416,31.99384847666827,0],[35.19100190706867,31.99399229698574,0],[35.1912551843681,31.99419611074399,0],[35.191106440425045,31.994320410858478,0],[35.191034976749215,31.994389034006264,0],[35.19100688822694,31.994416006935538,0],[35.19096383017873,31.994389025625832,0],[35.19085056968939,31.99431805670564,0],[35.190636309816014,31.994153806017604,0],[35.19050294233567,31.994023346005324,0],[35.19035807462309,31.993913175801982,0],[35.19023788542796,31.993821997261197,0],[35.19009174659922,31.993938580191365,0],[35.18986963994184,31.994013834130087,0],[35.189646123827806,31.993870527343724,0],[35.18946343614342,31.993748772777398,0],[35.18931696224309,31.993639553054745,0],[35.189162095383054,31.993537023929342,0],[35.18894592658972,31.993434452786467,0],[35.188773889331316,31.99335207184256,0],[35.1886039298762,31.993245646189205,0],[35.188408958628614,31.993328316739284,0],[35.188107181287016,31.99348760837889,0],[35.18780415079561,31.993680287810324,0],[35.18768752701383,31.993578753729924,0],[35.187482611416065,31.993458706886393,0],[35.18726295176954,31.993462587846555,0],[35.18694216697483,31.993263758139026,0],[35.18672357003527,31.993023553760594,0],[35.18652185782979,31.99279148481062,0],[35.186342009720036,31.992585450109434,0],[35.186020951837506,31.992221687804737,0],[35.18645003931948,31.992074219874972,0],[35.186470815555346,31.991894854766116,0],[35.186251218790886,31.991861456905056,0],[35.18600255793373,31.99182097809607,0],[35.18575397882325,31.991783741842603,0],[35.18547628980599,31.991798706743765,0],[35.185258522909756,31.991871027668466,0],[35.185112430793424,31.991952986336567,0],[35.185052239177814,31.99198675367666,0],[35.18492957512408,31.992094846260983,0],[35.18491853033767,31.99232466486126,0],[35.185010217785454,31.99253061024685,0],[35.18510846203652,31.992729847623043,0],[35.18517142136149,31.992889847320797,0],[35.1851830752057,31.993092226638517,0],[35.18511217836684,31.993135855987457,0],[35.18496566404231,31.993226021160265,0],[35.18471393543843,31.993216257784933,0],[35.1845328835862,31.993222076192993,0],[35.18439023740727,31.993038450652808,0],[35.18425560509902,31.992867720984076,0],[35.18412857523299,31.992708826728535,0],[35.18391220701367,31.992433317027313,0],[35.1837487342932,31.99213586969326,0],[35.18426082610744,31.992060815350108,0],[35.184511951941765,31.99198490687673,0],[35.18448652063607,31.991853541710828,0],[35.18401999766125,31.991746411862362,0],[35.18340067484984,31.991606248115403,0],[35.182889805642716,31.991491026757085,0],[35.18268033289151,31.991441545344,0],[35.182464754291296,31.991354355868992,0],[35.18230428823212,31.99103411388973,0],[35.18221885126207,31.99086120605461,0],[35.18211011379018,31.99064235808492,0],[35.18218622984084,31.990476919117263,0],[35.182306968804916,31.990214492845556,0],[35.18243671607466,31.98984378176261,0],[35.18273170933924,31.989722341848914,0],[35.18307988376695,31.989621230051533,0],[35.18325888207046,31.989540803007518,0],[35.183113853559426,31.989306025822064,0],[35.18304923594442,31.989196864809003,0],[35.18300857909295,31.98912818368118,0],[35.18294050565903,31.98885499466069,0],[35.18341663072592,31.988740475373316,0],[35.18348236584516,31.98856005383396,0],[35.18354320784104,31.988317843976674,0],[35.183548257271255,31.988109266626665,0],[35.18335729969636,31.987928414887786,0],[35.18314682891688,31.98788378800068,0],[35.182825343436264,31.98782550984924,0],[35.18268246459369,31.987632763260763,0],[35.18243958798861,31.987568925997557,0],[35.182220606570134,31.98739403597393,0],[35.18209599766382,31.987203860723767,0],[35.182044040006105,31.98703328324632,0],[35.182002103055375,31.986818674632698,0],[35.181949633357945,31.986559782376272,0],[35.18193582984527,31.98638318675857,0],[35.18192622595657,31.986105916285826,0],[35.18189893873151,31.98597694430725,0],[35.18184544315802,31.985852830988353,0],[35.181761656393185,31.98572532994688,0],[35.18153893798307,31.98572189819998,0],[35.18145629387527,31.985720625009616,0],[35.18119608517513,31.985658893162523,0],[35.181224324614384,31.98541553274179,0],[35.18122821162463,31.985171527076258,0],[35.180966765944355,31.98505565913075,0],[35.1807712440295,31.985063286136867,0],[35.180686879647894,31.985309861340507,0],[35.180521683958716,31.985144594097015,0],[35.18046632078777,31.984986203820004,0],[35.180417526996465,31.984842011269492,0],[35.18037333437606,31.98471293084231,0],[35.18028240061481,31.984492375928387,0],[35.18006738795324,31.98444585317762,0],[35.17991513159742,31.984489081285172,0],[35.17990985489344,31.984669512354767,0],[35.17990943807515,31.98484106798715,0],[35.17990812204324,31.984975494000818,0],[35.17989154543133,31.985167221365995,0],[35.179628380375576,31.985304386064016,0],[35.17938683866702,31.98530012912391,0],[35.179177144930264,31.985141601204628,0],[35.17905526330914,31.985045494867887,0],[35.17893427191847,31.984949370905845,0],[35.17881526310964,31.98485479662985,0],[35.178700606638344,31.98471851663563,0],[35.17877149629066,31.984554903266787,0],[35.17885772108322,31.98437727211727,0],[35.178940710144104,31.98417239115175,0],[35.17877734342486,31.983897217736832,0],[35.178634395412004,31.983698896088757,0],[35.178501195916624,31.983510192888733,0],[35.17841821134732,31.983392972665303,0],[35.17813516837096,31.983031593878298,0],[35.178103161397374,31.982998486905302,0],[35.17799998090387,31.98287233970419,0],[35.17790303920996,31.98300109584188,0],[35.17782369730912,31.983109785719716,0],[35.177745964290956,31.983219309046415,0],[35.1777457657633,31.983219590207412,0],[35.17766925265728,31.983330494823893,0],[35.1775943699935,31.983442197070207,0],[35.17755973993929,31.98349821424784,0],[35.177559702210054,31.983498279775652,0],[35.17752935532314,31.983556674206646,0],[35.17752929962759,31.9835567869754,0],[35.17750335987543,31.98361732397442,0],[35.17750333292599,31.9836173933119,0],[35.17748194583569,31.983679761237106,0],[35.17746239669849,31.98375640119702,0],[35.17746237783385,31.983756488059253,0],[35.17744975111421,31.98383457870566,0],[35.17744974123274,31.983834654900544,0],[35.17744413844035,31.983913639245632,0],[35.17744544009918,31.983984655075087,0],[35.17744544459076,31.98398475336634,0],[35.17745193402036,31.984055456742517,0],[35.17745194929174,31.98405558093983,0],[35.177463597746005,31.984125664037048,0],[35.177463613915684,31.98412574404142,0],[35.17748038007215,31.9841948662713,0],[35.17679546497368,31.983813939794995,0],[35.17676331696458,31.983719458068396,0],[35.17668593608601,31.98365047567921,0],[35.17641305934374,31.98356356986434,0],[35.176427462930995,31.98348011637073,0],[35.176424619763154,31.983404581011058,0],[35.17642298482934,31.983380571125394,0],[35.1764217783919,31.983370321338228,0],[35.17641345460246,31.98329959228964,0],[35.17641457120835,31.983218893019558,0],[35.17641854984676,31.983179758293996,0],[35.17642869811454,31.983135730279102,0],[35.17643937818493,31.98310693296062,0],[35.17646556138053,31.983077056704666,0],[35.17633630099765,31.982636112208294,0],[35.17633577009333,31.982505522283002,0],[35.1756311270929,31.982491739189676,0],[35.175456100241234,31.98247315269761,0],[35.17505792827977,31.982441989284165,0],[35.1748129235658,31.982438303681597,0],[35.17470771826964,31.982628609199754,0],[35.174680299890525,31.982799803670673,0],[35.1746483261546,31.983008411378847,0],[35.174592024244184,31.983305466949286,0],[35.17453253151785,31.983323170931072,0],[35.17447241266579,31.983339280903852,0],[35.17441202521745,31.98335369933856,0],[35.17435112842434,31.983366484906302,0],[35.17423739542116,31.983388903838783,0],[35.17412292400283,31.983407179268735,0],[35.17400786418796,31.983421286054295,0],[35.17389236779188,31.98343120667241,0],[35.17387729585804,31.983431591458256,0],[35.17386232633214,31.983433123744085,0],[35.17386226255175,31.983433132125597,0],[35.17384737836581,31.983435816483052,0],[35.17383283284474,31.983439608718893,0],[35.17383280140371,31.9834396178623,0],[35.17380471467803,31.983450502347726,0],[35.17380467335553,31.983450522158485,0],[35.17377857819484,31.98346555470894,0],[35.17377853417738,31.983465583663094,0],[35.17375500191022,31.983484448828488,0],[35.17373464878082,31.98350664829013,0],[35.173734611949904,31.983506693245236,0],[35.17371785208162,31.983531775925456,0],[35.173689602760895,31.983598714089872,0],[35.17364490438899,31.983716741717323,0],[35.173635610419055,31.98374391208201,0],[35.17363559065612,31.98374395779897,0],[35.17362205484142,31.9837693032869,0],[35.17362203867174,31.983769329193166,0],[35.17360462213501,31.983792160241723,0],[35.17360458979569,31.983792196815276,0],[35.17358372732153,31.983811950346084,0],[35.17358370037204,31.98381197320454,0],[35.17355993993279,31.983828121950925,0],[35.17355990939005,31.983828140999623,0],[35.17354720631363,31.983834696807698,0],[35.173533868128295,31.983840269701414,0],[35.173533833094005,31.98384028417841,0],[35.173520207447766,31.98384472938761,0],[35.1735061560001,31.983848088057638,0],[35.173491953635455,31.98385029389924,0],[35.1734775689128,31.983851350722055,0],[35.17347750962399,31.983851352245974,0],[35.173463134782835,31.98385124938293,0],[35.17344883629844,31.98384999216755,0],[35.17315246232329,31.98386484864242,0],[35.17307573721486,31.983869027168407,0],[35.1730480565277,31.983870358292524,0],[35.1730205617918,31.983873386276,0],[35.17299321797285,31.98387812178594,0],[35.17296634127786,31.983884494722854,0],[35.172939754738735,31.98389256299441,0],[35.172913896733284,31.98390218487783,0],[35.17288848159727,31.98391347009316,0],[35.17286402496366,31.98392618700756,0],[35.17325683128793,31.982204690123154,0],[35.17287858036619,31.981957372802576,0],[35.17323672968681,31.981281530720068,0],[35.17327111270431,31.981216633708332,0],[35.17337783076343,31.98101888003137,0],[35.17355190989247,31.98104276861955,0],[35.1737529681244,31.9810785592007,0],[35.17382458002224,31.98087205472353,0],[35.17390930462825,31.980628308238053,0],[35.17407378885172,31.980157573824734,0],[35.174173568323596,31.979871978937187,0],[35.174329965912854,31.979845664655638,0],[35.174534725203785,31.97981124211375,0],[35.17477353603387,31.979771091735948,0],[35.17517784169208,31.979657692655174,0],[35.175095186804484,31.979432424139812,0],[35.17528524875904,31.979304953037612,0],[35.17524027729928,31.979102452626787,0],[35.17521163361813,31.979011385854967,0],[35.175152251384596,31.978822589195847,0],[35.175327441729614,31.978700250783277,0],[35.17542627437717,31.978522519146377,0],[35.17556105400915,31.978330120295347,0],[35.175629536176515,31.978173576000785,0],[35.17554327455303,31.978023080172377,0],[35.17545221772258,31.97791230020472,0],[35.17535730801787,31.97780247107801,0],[35.17523545604116,31.977692823937826,0],[35.17512181466614,31.977602157341465,0],[35.17492781270075,31.977617634334283,0],[35.174827010047785,31.97751651300632,0],[35.174729258073505,31.977211968009886,0],[35.174701872932054,31.97715952231877,0],[35.17459574865935,31.976956275741955,0],[35.17453567382472,31.97691556480246,0],[35.174385821360616,31.97681372184216,0],[35.17426692034959,31.976728825062935,0],[35.17410509064778,31.976728012000542,0],[35.173917688604796,31.976808018980496,0],[35.173686872780756,31.976514353893126,0],[35.17371510593183,31.976440045731994,0],[35.173723003919775,31.97641173018884,0],[35.17372924271945,31.976384040247773,0],[35.173733631887906,31.976352692645772,0],[35.173737467694174,31.976298711010614,0],[35.17374266175316,31.976225622656134,0],[35.173756697031145,31.976113481849673,0],[35.17376015464667,31.976076598129026,0],[35.17376476480071,31.97602742235184,0],[35.17376950610879,31.97600444611267,0],[35.17377633420326,31.975984641370225,0],[35.1738185478351,31.975923600216213,0],[35.173843548847785,31.975889215827916,0],[35.173885564850224,31.9758081008385,0],[35.17391251520708,31.975755864661547,0],[35.17386880138872,31.97571265530022,0],[35.17384679625752,31.975699796274476,0],[35.17382068402883,31.975687376168448,0],[35.17376445128869,31.975665391989914,0],[35.17372046258585,31.975648194795877,0],[35.173667691952794,31.97562698786528,0],[35.173633615260805,31.97561329289477,0],[35.17359451429144,31.975595672009412,0],[35.17355111218848,31.975572335989966,0],[35.17348384903497,31.975532134226448,0],[35.17345176839953,31.97551533097075,0],[35.17340942900357,31.975493154722425,0],[35.173391819329034,31.975480354341364,0],[35.17337901474297,31.975466772127664,0],[35.1733622297219,31.97543813623647,0],[35.17336208329652,31.975388221720827,0],[35.17337089666777,31.975365701009093,0],[35.173387872131684,31.975332188162028,0],[35.17339741942654,31.975313340371173,0],[35.173407069129325,31.975290212311343,0],[35.173440691273754,31.97519716507522,0],[35.17345751043084,31.975127974343774,0],[35.173393118292935,31.975157235950874,0],[35.173312984976356,31.975196102056533,0],[35.17323422967539,31.97523707589373,0],[35.17320915859413,31.97520098584627,0],[35.17318234837445,31.975166844271865,0],[35.17314880079018,31.975128721124467,0],[35.1731138428509,31.975092852782645,0],[35.17306734425518,31.975050165094128,0],[35.17301216703546,31.975006322160166,0],[35.172960000968615,31.974969297782454,0],[35.17293426154078,31.97495353077442,0],[35.17290448957561,31.974937448286276,0],[35.172823660962976,31.974898970702853,0],[35.17279200792565,31.974883903982008,0],[35.17274729697731,31.974860439761652,0],[35.17268173074137,31.97481863515049,0],[35.17265577212458,31.974802083994042,0],[35.17261654628938,31.97478068102781,0],[35.172557738079334,31.97475666888564,0],[35.17248827584997,31.974734052765918,0],[35.17236300758022,31.974640735209086,0],[35.17228305841825,31.97452842482032,0],[35.17209108844206,31.974677316982866,0],[35.17189797940205,31.974531075909173,0],[35.17159390057669,31.974355344140836,0],[35.17131662478446,31.97409557086566,0],[35.17103158575155,31.973870419766694,0],[35.17077779102252,31.97369050698211,0],[35.17076354284383,31.973625391232726,0],[35.17076587307367,31.973591464727846,0],[35.17078102226262,31.97356098031875,0],[35.17081150030357,31.97352745004797,0],[35.170840546429986,31.97350192570122,0],[35.17091262904501,31.97344180876874,0],[35.17098953471479,31.973386203809735,0],[35.171102661355135,31.97339386760146,0],[35.17121593172594,31.97339980004798,0],[35.171329250605766,31.973403996577268,0],[35.1714426395542,31.973406457189746,0],[35.1714867504279,31.97340488130047,0],[35.17148682678472,31.973404872918042,0],[35.171530458856374,31.973398749963053,0],[35.17157329771566,31.97338811575704,0],[35.1715733884455,31.9733880883238,0],[35.17161480527168,31.97337310822702,0],[35.171690108347,31.97334306115403,0],[35.17169024758585,31.973343010097654,0],[35.171766681640115,31.973316424183196,0],[35.1717668325571,31.9733163761749,0],[35.17184437423412,31.973293248373913,0],[35.171929768085,31.973272662721037,0],[35.17192990822218,31.973272635287707,0],[35.17201625159236,31.97325728863243,0],[35.17201640161101,31.97325726805742,0],[35.17210350765086,31.97324717869139,0],[35.17210361814364,31.97324717107101,0],[35.17219121556194,31.973242374811548,0],[35.17223294500184,31.973241342251683,0],[35.17227457742365,31.97323871017648,0],[35.17227466905183,31.973238701794106,0],[35.17231617391288,31.97323447553776,0],[35.172357412872636,31.973228670340784,0],[35.17235753234859,31.973228649003726,0],[35.1723985988318,31.973221252673177,0],[35.172439235920294,31.97321231169298,0],[35.17280017900145,31.973125361700863,0],[35.172800479937074,31.973038928288474,0],[35.17279586259653,31.972952616720985,0],[35.172786706967145,31.972862655663036,0],[35.172774128756515,31.97277310982916,0],[35.172758145931,31.972684108005495,0],[35.172738515047094,31.972594603147673,0],[35.17271543912408,31.97250592273303,0],[35.17265859373289,31.972314168913286,0],[35.17265852276599,31.972313944872212,0],[35.17259628388985,31.97212412091421,0],[35.17259618507517,31.972123835908967,0],[35.17252855990058,31.971935934204055,0],[35.17245367274525,31.97174538932781,0],[35.17237323310312,31.97155712030176,0],[35.172339213004975,31.971475798778073,0],[35.172339168987556,31.971475685994484,0],[35.17230903140806,31.971392978987907,0],[35.172308978407465,31.971392818956925,0],[35.172282751194444,31.971308836961267,0],[35.17228271166857,31.971308698267634,0],[35.17226043255119,31.971223560159753,0],[35.172240627394146,31.971129249125305,0],[35.17222566685139,31.97103405019976,0],[35.17221861058482,31.970989139231815,0],[35.1722017698682,31.97091506893125,0],[35.17220174741031,31.97091498586715,0],[35.17217872718286,31.970842688050716,0],[35.17217869574182,31.970842607272704,0],[35.17214964512385,31.970772514793143,0],[35.17211812324051,31.97070625922136,0],[35.1720527187013,31.97057822579269,0],[35.172118460108756,31.970533246016373,0],[35.172133747638256,31.970527648690755,0],[35.17214959930977,31.970523324003928,0],[35.17214964422553,31.970523314859225,0],[35.17216566927188,31.97052036492734,0],[35.17218196021954,31.97051877298527,0],[35.17219829787962,31.970518562656892,0],[35.17221457894585,31.97051973089398,0],[35.17221462655656,31.97051973470422,0],[35.1722308330626,31.970522284554946,0],[35.172246666767805,31.970526170295646,0],[35.172262219300315,31.970531414787896,0],[35.17227711606265,31.97053788390906,0],[35.172277167266614,31.970537906770886,0],[35.17229165978713,31.970545714829594,0],[35.17230526207714,31.97055460120126,0],[35.17235072311872,31.97058154913154,0],[35.17235075994967,31.970581574279514,0],[35.172392737324564,31.97061361427766,0],[35.17239280200326,31.970613667621755,0],[35.172430770197046,31.97065039883983,0],[35.17243081421451,31.970650446087454,0],[35.17246425040771,31.970691367085664,0],[35.17246427915377,31.970691405950593,0],[35.17249273778199,31.97073598785537,0],[35.172518043323564,31.97077213681268,0],[35.17251807476459,31.97077217796379,0],[35.17254846297401,31.970804204940443,0],[35.17254848273694,31.970804224753987,0],[35.17256525877487,31.970818371579703,0],[35.17258325741991,31.970831392083305,0],[35.17258329784411,31.970831421041453,0],[35.172601992683475,31.970842934957073,0],[35.172621708907336,31.97085314804065,0],[35.172621752026465,31.970853169378206,0],[35.17264197310353,31.970861805765587,0],[35.17266297212158,31.97086898281403,0],[35.17266299907106,31.97086899195868,0],[35.17268429543148,31.9708745450642,0],[35.172706074187246,31.970878526809088,0],[35.17270613437435,31.970878536715816,0],[35.17272809009821,31.970880886897785,0],[35.17275020392556,31.970881601706672,0],[35.173086089400215,31.97090077428152,0],[35.17315237428837,31.970885523248818,0],[35.1731652597228,31.97062470908841,0],[35.17314654691713,31.970544164801193,0],[35.173063672840605,31.970218028796094,0],[35.1729885718862,31.969913651622594,0],[35.17295213082841,31.969746792129552,0],[35.172959429640095,31.969717521939025,0],[35.17295506472613,31.969666458164465,0],[35.17295881788737,31.969548900189526,0],[35.172961793107596,31.969441159791163,0],[35.17276905507181,31.96943776477659,0],[35.17265271336105,31.96929925874398,0],[35.17255102317256,31.969093611764723,0],[35.17288455955274,31.968954690645464,0],[35.17332844498237,31.96901926711296,0],[35.17335518513343,31.96888562399872,0],[35.173272505991314,31.968608331138853,0],[35.17302660206375,31.96856250982792,0],[35.17294769404921,31.96838255006018,0],[35.17281409031193,31.968270267069858,0],[35.1726840951072,31.968123848893132,0],[35.17257520761665,31.967998006654177,0],[35.17276195388949,31.96786864799917,0],[35.17290543101004,31.96780934966371,0],[35.17295169873874,31.96779022826484,0],[35.173062777220274,31.967674941181016,0],[35.17307133816491,31.96764774319628,0],[35.17310386975463,31.967544397030014,0],[35.17311863805788,31.967497480834734,0],[35.1731266375555,31.967472066075672,0],[35.173128185352724,31.967467152915457,0],[35.17312973135333,31.967462238992926,0],[35.17313488139486,31.96743849928692,0],[35.173135720421314,31.967434630943487,0],[35.17326146928974,31.96744323793117,0],[35.17328684400158,31.967254730693888,0],[35.173338382146056,31.96725949830688,0],[35.173363196309154,31.967253431336374,0],[35.17356706626792,31.96720358705448,0],[35.17357986187085,31.96720363506597,0],[35.17370299125191,31.967204096890626,0],[35.1737579995883,31.967204302654117,0],[35.17391981761202,31.967036750070886,0],[35.17391443311022,31.966770133850176,0],[35.17409248369108,31.96667939397288,0],[35.174250249414555,31.966708636934726,0],[35.174405733417174,31.966749539113483,0],[35.174651659802635,31.96684187397573,0],[35.17485897210558,31.966945899954176,0],[35.17486541212787,31.966920760156665,0],[35.17487768311462,31.966853710755732,0],[35.17487773162367,31.96685354462017,0],[35.17487781696362,31.96685339067798,0],[35.174877934642915,31.966853251977664,0],[35.174878082864936,31.96685313613998,0],[35.17487825264652,31.966853044689252,0],[35.17487843859778,31.96685298295994,0],[35.174878637125474,31.966852951714245,0],[35.17487880870369,31.966852953238455,0],[35.174878727855315,31.966853850218158,0],[35.17492893469656,31.966980245777712,0],[35.17510961734122,31.96706140667279,0],[35.175128078618606,31.967058791186382,0],[35.175145728717304,31.96705579084534,0],[35.17516690739844,31.967059801715244,0],[35.175208420344376,31.96706951376571,0],[35.17539970131276,31.967023361702424,0],[35.17543003831821,31.966959881239124,0],[35.17547319967268,31.966791437326176,0],[35.17549049134358,31.96678360684755,0],[35.17549544555237,31.96682710467171,0],[35.175498834895954,31.966848930166087,0],[35.17549884387909,31.966848969794754,0],[35.175505899247334,31.966869895256046,0],[35.175505917213634,31.966869937933044,0],[35.17551645804518,31.966889394080958,0],[35.1755301420819,31.966906736950797,0],[35.17553016723475,31.966906765148135,0],[35.17554660011621,31.966921519197527,0],[35.17554663425221,31.966921545108605,0],[35.17555569016858,31.96692778738158,0],[35.17556537760061,31.966933304907336,0],[35.17562990089253,31.96696588421355,0],[35.1756969071279,31.966992993997984,0],[35.17570784321816,31.966996972862884,0],[35.175707898913714,31.966996995725523,0],[35.17571823403105,31.96700236921238,0],[35.17571827715018,31.96700239436128,0],[35.175727864869195,31.967009096168148,0],[35.17576956017311,31.966707147046723,0],[35.175829046611234,31.966692274838753,0],[35.17607746222832,31.96658888720602,0],[35.17606642642508,31.966569263334215,0],[35.17605855718317,31.966548189196367,0],[35.17605854460674,31.966548144995002,0],[35.176054030572466,31.966526144147885,0],[35.17605402518258,31.966526089277195,0],[35.17605296067895,31.96650366470116,0],[35.17605296427221,31.966503599923314,0],[35.17605537085886,31.966481291179864,0],[35.17605538074033,31.966481243930104,0],[35.176061209009895,31.966459547142076,0],[35.17607032421508,31.96643898129529,0],[35.17609273358814,31.966422622199637,0],[35.17611739324103,31.96640990514603,0],[35.176130327184474,31.96640502927161,0],[35.17614371387885,31.966401131162993,0],[35.17615727035478,31.966398297699012,0],[35.176171072070815,31.96639650982737,0],[35.176184933973964,31.966395794983544,0],[35.176198814741745,31.966396150881277,0],[35.1762544653736,31.966375347247038,0],[35.17625456598491,31.966375303045584,0],[35.176308264577635,31.96635014175317,0],[35.176308332849615,31.96635010593477,0],[35.17635986560418,31.96632069519799,0],[35.17635991411322,31.966320663952168,0],[35.17640893158501,31.966287195814708,0],[35.17640901872159,31.966287128750395,0],[35.1764551508047,31.966249865368503,0],[35.1764551508047,31.96624070498803,0],[35.176455156194585,31.966240643258374,0],[35.176456265613965,31.966231613195227,0],[35.17645628088532,31.966231542320383,0],[35.17645847816451,31.96622272411878,0],[35.17646252417654,31.966212548624892,0],[35.17646801018798,31.96620307197117,0],[35.17647481762122,31.96619449535104,0],[35.17648721527043,31.966178600327893,0],[35.17648724491483,31.96617855307798,0],[35.17649701409357,31.966160982203984,0],[35.17650396615554,31.966142060130856,0],[35.17650397963026,31.966142006784164,0],[35.176507917844475,31.96612229212737,0],[35.17650876136255,31.966102150692592,0],[35.17650875776929,31.966102092773266,0],[35.17650649042149,31.966082121281502,0],[35.17650075557671,31.966056742711263,0],[35.17650035672474,31.966056723658877,0],[35.17649349000269,31.966030845908318,0],[35.176492225174776,31.966026566735433,0],[35.17648538360559,31.96600533014648,0],[35.17648391396177,31.966001117274867,0],[35.176483689382955,31.966000481686024,0],[35.17648347827887,31.965999885726244,0],[35.176481924193425,31.96599558521324,0],[35.17648082465551,31.965992603127802,0],[35.17647833003397,31.965986039186298,0],[35.17647438283663,31.96597609762993,0],[35.17645494688713,31.96591819499709,0],[35.1764549334124,31.965918140126035,0],[35.176441978807695,31.965858509780233,0],[35.17644196533297,31.96585841985267,0],[35.17643563310853,31.96579776292128,0],[35.17643563041357,31.965797682138867,0],[35.176435988841384,31.96573668603324,0],[35.17643599333294,31.965736632686305,0],[35.17644303971803,31.96567601682785,0],[35.176449898355244,31.965642799948416,0],[35.176457352575454,31.965606889794923,0],[35.17645881143947,31.965570244200475,0],[35.176454231828174,31.96553385465728,0],[35.176443741302265,31.965498711897002,0],[35.17643181077698,31.965461951944157,0],[35.17643179999722,31.965461906218035,0],[35.17642418767348,31.965424064066067,0],[35.176424177792015,31.965423987093804,0],[35.17642097529802,31.965385551248684,0],[35.1764209743997,31.96538551390574,0],[35.17642221227816,31.96534692409984,0],[35.17642930717227,31.965261997662388,0],[35.176440397772765,31.965177500972846,0],[35.17645660338051,31.96508823266953,0],[35.176466863937684,31.965032791075693,0],[35.17646687471745,31.965032698098906,0],[35.1764717202301,31.964976617065123,0],[35.176471722026754,31.964976543903028,0],[35.17647112464709,31.964920237251597,0],[35.176467941017705,31.964857816186218,0],[35.17646794011941,31.964857697297603,0],[35.17646883394309,31.96479531962981,0],[35.17646884202793,31.964795171781052,0],[35.17647379803335,31.96473301584405,0],[35.17647277664888,31.96470727185135,0],[35.17647277036067,31.964707220028064,0],[35.17646785208449,31.964681982829806,0],[35.176459125849824,31.96465774322415,0],[35.176459101595306,31.964657692162902,0],[35.176446815337165,31.964635110136232,0],[35.176428858912956,31.964610001714508,0],[35.176412584134965,31.964580206317567,0],[35.17639928817043,31.964545643157223,0],[35.176390858379804,31.964509583201234,0],[35.176387572342485,31.96447578974501,0],[35.176388580252265,31.964441852999645,0],[35.17639361171617,31.964384686359868,0],[35.176392391804015,31.964324003305233,0],[35.176384221626485,31.964265977692683,0],[35.17636929971129,31.964209311650865,0],[35.17635193258191,31.964163817376907,0],[35.176351901140876,31.964163745738347,0],[35.176330214013284,31.964120229885907,0],[35.17633016999586,31.964120152912553,0],[35.17630434971962,31.96407896834273,0],[35.176267955374215,31.964023965116745,0],[35.17626781523703,31.964023744103905,0],[35.17623308187656,31.963967983303746,0],[35.17627354199696,31.96395133035399,0],[35.176895905605576,31.963745021311002,0],[35.17691267805025,31.963816606042496,0],[35.1769518652579,31.963807071220717,0],[35.17701339895655,31.96394547427045,0],[35.177630164264315,31.963770703080044,0],[35.17758660675282,31.9636928651507,0],[35.177516408803264,31.963577313039973,0],[35.17751628573407,31.963577098885086,0],[35.1774500026425,31.963459539971996,0],[35.17744990203119,31.963459351728844,0],[35.177387458339155,31.963339673212133,0],[35.177353421173066,31.963271042084358,0],[35.17726887892503,31.96309435287585,0],[35.17724544726917,31.96303729895329,0],[35.17722761391413,31.962978255856882,0],[35.177215544149995,31.9629177707867,0],[35.1771495889435,31.96247338827578,0],[35.17735007674524,31.962425324775126,0],[35.1774717194145,31.962402669797434,0],[35.17747193770513,31.9624026233077,0],[35.17759225985089,31.962374734798384,0],[35.177435032218305,31.96209774084422,0],[35.17742601492947,31.9620620968118,0],[35.17741109391262,31.96202849298728,0],[35.17739041379644,31.961987162674554,0],[35.17738116204733,31.96194059574395,0],[35.17742655661359,31.9619168858576,0],[35.177468881636536,31.961888050634,0],[35.177507558601064,31.9618544810417,0],[35.177542063789446,31.961816635116563,0],[35.177571924687825,31.961775028054614,0],[35.17759673615596,31.961730225352856,0],[35.17754668831654,31.96170828889459,0],[35.17727131874935,31.961586541951608,0],[35.17729483664349,31.961562209310596,0],[35.1769099408836,31.96129912798444,0],[35.17706363903545,31.961020970049297,0],[35.1770544510667,31.960985308831866,0],[35.17690242018803,31.960395253182725,0],[35.17664323197406,31.960379777858957,0],[35.176505961313794,31.960114418902393,0],[35.17642254106156,31.95995320206702,0],[35.17622729762445,31.959572565198602,0],[35.17609796357974,31.959312490961086,0],[35.17634525091283,31.95921552911675,0],[35.176669629867,31.959005573192517,0],[35.17662532944873,31.95889336028583,0],[35.17599927556095,31.95777334097302,0],[35.17583350674663,31.95749550313936,0],[35.17567957862605,31.957242922769062,0],[35.17562438972827,31.957068595362777,0],[35.175570738746224,31.956983805319517,0],[35.17557043062409,31.95687076679609,0],[35.17575756137588,31.956659314698392,0],[35.175875918007826,31.9565570750379,0],[35.175928523350855,31.956505253963336,0],[35.17596962037676,31.956468840249006,0],[35.1760830389696,31.95638201006714,0],[35.176173440029906,31.956327397038777,0],[35.176304932726275,31.956247577997505,0],[35.176441351783616,31.956174766355936,0],[35.176548185725395,31.956121557137873,0],[35.1767602078954,31.956013740009404,0],[35.17692292064112,31.95593673237923,0],[35.17712015025332,31.955837315033808,0],[35.17734367714715,31.955723897057013,0],[35.17755240878828,31.955621680745153,0],[35.17774470485292,31.95552646574054,0],[35.17787812263894,31.95546063284998,0],[35.17791596237364,31.955397619234287,0],[35.177949617755765,31.955333229068444,0],[35.17796610363786,31.955296227244286,0],[35.17796736038093,31.95529340868133,0],[35.177968610835826,31.955290599264558,0],[35.17798695533222,31.95524219130743,0],[35.178037847588016,31.955082712091052,0],[35.178080234594695,31.954950570783115,0],[35.17810507840218,31.954860823791687,0],[35.1781221356128,31.95478576487692,0],[35.178136242756025,31.9547117691567,0],[35.178147381865564,31.95463893571851,0],[35.17815553856834,31.954567349930525,0],[35.17815912015137,31.95453281577584,0],[35.17816681332348,31.954458621681802,0],[35.17816700017304,31.95442516522714,0],[35.17816398363032,31.954395556311738,0],[35.1781562536273,31.95436209602312,0],[35.17814353797445,31.95432560600198,0],[35.17812608909836,31.954285994781415,0],[35.178096866003884,31.954227325631525,0],[35.17807099901526,31.95417924562013,0],[35.17804195738044,31.95413137899827,0],[35.17800993693213,31.95408404512639,0],[35.177975182012126,31.954037609097213,0],[35.17793749229604,31.953995294241356,0],[35.17784613991987,31.953906117964486,0],[35.17781151435725,31.953865777902145,0],[35.17778038144445,31.953819536123117,0],[35.177868596005354,31.95374211277951,0],[35.1779520818346,31.953672431028483,0],[35.17798729220047,31.953643282238957,0],[35.17836451005964,31.953329949126154,0],[35.178365686852636,31.953328087066485,0],[35.17836686274737,31.953326225006776,0],[35.1783885480783,31.953308124991782,0],[35.17849745982336,31.953217219371407,0],[35.17850358274035,31.953207678113788,0],[35.178509705657326,31.953198136092922,0],[35.17918664910596,31.95214324696089,0],[35.18054328125477,31.95285562726942,0],[35.18038198066069,31.953163635722632,0],[35.180320958103415,31.953280162073685,0],[35.18064415128141,31.95349311586403,0],[35.18103245704613,31.953748973329272,0],[35.18157342161189,31.95401766928043,0],[35.181621526395354,31.95398873630206,0],[35.181626291957954,31.953997962691442,0],[35.18163105662223,31.9540071890799,0],[35.18177596386068,31.954287754687673,0],[35.18184032725249,31.95440786115831,0],[35.18210273862171,31.95423492013839,0],[35.18218318455201,31.954288619777987,0],[35.18240721360412,31.95418541787518,0],[35.18236675258539,31.95409340793922,0],[35.18233036812145,31.95399971193241,0],[35.18229212414485,31.95388483131629,0],[35.18226017376515,31.953768044298172,0],[35.18225225601424,31.95373452280506,0],[35.182238262058725,31.953660386755548,0],[35.182233555784954,31.95362694601631,0],[35.182232769759096,31.953620568692024,0],[35.18223201966582,31.953614186794134,0],[35.182231654051506,31.9536109962261,0],[35.182231306403494,31.953607801846946,0],[35.18223095606052,31.95360460899212,0],[35.182230626378825,31.95360141308831,0],[35.18222936963572,31.953588624136803,0],[35.18222907588664,31.953585500641474,0],[35.18222879471394,31.95358222470603,0],[35.18222775356654,31.9535694166968,0],[35.182227435562936,31.953565146089662,0],[35.18222731968024,31.953563501261787,0],[35.182227284645954,31.953563008880526,0],[35.182227134627304,31.953560873195737,0],[35.182226917235006,31.95355758277765,0],[35.18222685165799,31.953556598777197,0],[35.182224749600216,31.953510179249793,0],[35.182224413630294,31.953487455761348,0],[35.182241144752474,31.953457517272916,0],[35.18225787677298,31.953427577250235,0],[35.18232729678147,31.953420086335996,0],[35.1823274746479,31.95342007185414,0],[35.1823969871829,31.953415763130035,0],[35.182458970039185,31.953414590102106,0],[35.182520950200555,31.95341591480812,0],[35.182535522671074,31.953416590118472,0],[35.18254280710973,31.953416980365574,0],[35.182555448202386,31.953417727322876,0],[35.182561618730084,31.953418135862833,0],[35.18256477630832,31.953418356139004,0],[35.18257686044551,31.953419250201133,0],[35.18262107732044,31.953412071788794,0],[35.182626096207926,31.953411478033914,0],[35.182626378278904,31.953411446021466,0],[35.182627437392654,31.953411315685045,0],[35.18263061922537,31.953410962785785,0],[35.18265942999319,31.953408542796303,0],[35.18266585204913,31.95340819065926,0],[35.18267868807622,31.953407690655123,0],[35.182697034369276,31.953407449799478,0],[35.18271541030674,31.953407762302078,0],[35.18273010764308,31.95340841169766,0],[35.18274611023158,31.953409532895943,0],[35.18277484913412,31.95341260914077,0],[35.18278119034173,31.95341347195274,0],[35.1827821811835,31.95341361829538,0],[35.182782686935,31.95341368689353,0],[35.18278316573705,31.953413756253834,0],[35.182783232212365,31.953413766162456,0],[35.182785015368204,31.953414026073148,0],[35.18278514292896,31.953414045128156,0],[35.18282472180208,31.953421308144712,0],[35.18286730643811,31.95343229908692,0],[35.182933744039914,31.95345435413863,0],[35.18300387192085,31.953479955705596,0],[35.18302178073439,31.953486862006965,0],[35.18303410023018,31.953491701219516,0],[35.18304991237583,31.953498019863268,0],[35.18306244477233,31.95350311517465,0],[35.18306977861834,31.953506131964662,0],[35.18308320034697,31.95351172194372,0],[35.183090208104524,31.953514676233016,0],[35.18309244131632,31.953515623648297,0],[35.1830946736298,31.953516571063567,0],[35.183100772292256,31.95351917474045,0],[35.18310408617736,31.95352059776878,0],[35.18311376732114,31.953524788346947,0],[35.18311877632719,31.95352697433779,0],[35.18312340265091,31.953529004839723,0],[35.18313022805042,31.953532020866717,0],[35.183132690332634,31.953533114624268,0],[35.183140243367525,31.95353648888529,0],[35.183143584202064,31.953537991182216,0],[35.18314784491147,31.95353991573803,0],[35.18315309736093,31.953542302187238,0],[35.18315836508174,31.95354470921574,0],[35.18315888071471,31.953544944735636,0],[35.183160982772485,31.95354590968117,0],[35.183162101175,31.953546424166372,0],[35.18316221885432,31.953546478282593,0],[35.183162961761056,31.953546819748304,0],[35.18316303093133,31.95354685176069,0],[35.18316354027612,31.953547087280572,0],[35.183164698204514,31.953547620058558,0],[35.18316475839162,31.953547648259978,0],[35.183164850019786,31.953547690180972,0],[35.18316549590847,31.953547988963475,0],[35.183165690842905,31.953548078140937,0],[35.1831660429825,31.953548241251777,0],[35.18316623971353,31.953548331953602,0],[35.18316723055529,31.95354879308478,0],[35.18317128734712,31.953550675719335,0],[35.18317483569249,31.953552325882878,0],[35.18318838767687,31.95355870092526,0],[35.18320608358965,31.953567168968736,0],[35.18322101179302,31.95357444721721,0],[35.183233222592705,31.953580493749868,0],[35.18323996714384,31.95358387182015,0],[35.18324937340318,31.95358865691139,0],[35.18325877876419,31.953593442002372,0],[35.18326258492606,31.95359539170959,0],[35.18330775671014,31.95361852675915,0],[35.18333609226915,31.95363508325893,0],[35.183366237035116,31.95365598505434,0],[35.18339285411698,31.953680120093928,0],[35.183394550136235,31.95368191278636,0],[35.18339624525719,31.953683704716543,0],[35.1834154718992,31.953707056970533,0],[35.18341832405025,31.95371131308927,0],[35.18342079172235,31.953715486128164,0],[35.183421117810795,31.9537160707347,0],[35.1834210836748,31.953716072259077,0],[35.18343368793654,31.953736317783015,0],[35.183442735768075,31.9537452423671,0],[35.18345457736019,31.953753957345697,0],[35.183493628023875,31.953775760794766,0],[35.18349685297575,31.95377756186949,0],[35.18353435404561,31.953796019262917,0],[35.18356933893434,31.953810404228378,0],[35.18361717961313,31.953830075796546,0],[35.18377608529866,31.95390436414853,0],[35.18390820232414,31.953966128785936,0],[35.18397256302099,31.953994772136742,0],[35.18400237720695,31.95400366087245,0],[35.18403694527739,31.95401043908548,0],[35.18411276398568,31.95401895967884,0],[35.18416454018372,31.954024772950206,0],[35.18436598019965,31.954052557287753,0],[35.184507445093956,31.95406854130011,0],[35.18461550613444,31.95407694527214,0],[35.18471529009789,31.954080693751358,0],[35.18475026600348,31.9540806990867,0],[35.184787875769494,31.95408043003162,0],[35.184812681847745,31.95408070899526,0],[35.184882598624604,31.954084693755036,0],[35.184938617565734,31.9540878873554,0],[35.18499280035039,31.954088420892443,0],[35.18502795502074,31.954087919367595,0],[35.18512836331331,31.954086484915155,0],[35.18520153288983,31.954089352295654,0],[35.185251463948255,31.954091317998508,0],[35.185281389525336,31.954091099248316,0],[35.18530803176002,31.95408937592373,0],[35.185352208210745,31.954082660978816,0],[35.18538546474089,31.954075514630514,0],[35.18545412477468,31.954060766139047,0],[35.18552297165806,31.954049323289766,0],[35.1855538476527,31.9540464589568,0],[35.18558855316536,31.95404516169901,0],[35.185662741431415,31.954045948285387,0],[35.18571439725521,31.95404648868244,0],[35.18575356739485,31.954046490206867,0],[35.185755312821435,31.954046494779995,0],[35.18585897032042,31.9540473362445,0],[35.185919255360794,31.954046519170284,0],[35.18598839060338,31.95404303517173,0],[35.186035853091425,31.954039571752407,0],[35.18615601803202,31.954030807258096,0],[35.186194756082024,31.954031151008643,0],[35.186230859373296,31.954031471893238,0],[35.186249457194606,31.954029375091345,0],[35.18626516423736,31.954025096121455,0],[35.18628949331022,31.954013651743306,0],[35.186312191042475,31.9539981036978,0],[35.18634349733013,31.954012236344592,0],[35.18637917931154,31.954026526001705,0],[35.18641403124962,31.954042221146263,0],[35.18641410760641,31.954042256207313,0],[35.18644850859022,31.954059527570536,0],[35.18648193939354,31.954078119815968,0],[35.18651472790139,31.954098209772223,0],[35.18654642226126,31.954119527621,0],[35.186546501312996,31.95411958097469,0],[35.18660733881729,31.95416633479777,0],[35.18660845811814,31.954167277633143,0],[35.18661176302007,31.95417007031604,0],[35.18663002576979,31.954185998667757,0],[35.18666039870785,31.954208985702763,0],[35.18666044811519,31.954209017714906,0],[35.186693762137516,31.954227513893592,0],[35.18669380256172,31.95422753371065,0],[35.18672939830484,31.95424116174943,0],[35.18672943244083,31.954241173182314,0],[35.186766560709835,31.954249654120176,0],[35.18676662359189,31.95424966479091,0],[35.186804640294724,31.954252844666037,0],[35.18685384012452,31.954255304267352,0],[35.18685403595726,31.954255317986867,0],[35.18690323758368,31.954260327890395,0],[35.18730537291218,31.95427767085895,0],[35.18731803736105,31.954278599211463,0],[35.187330749420646,31.95427858472976,0],[35.18733082577744,31.95427858396761,0],[35.187343553108406,31.95427762207849,0],[35.18735613311563,31.954275721928358,0],[35.1873561834213,31.954275712019836,0],[35.18738073886959,31.954269144191976,0],[35.18738079007356,31.95426912513713,0],[35.18740409866021,31.95425899633688,0],[35.18740415974568,31.954258961275958,0],[35.187425700447854,31.954245503209176,0],[35.18742960722103,31.954242555040935,0],[35.18742963327218,31.954242533699528,0],[35.18743080377699,31.95424161373075,0],[35.187431764974356,31.954240853822807,0],[35.18743271539192,31.954240080195397,0],[35.187433213058576,31.954239673183505,0],[35.18743343494246,31.954239491781205,0],[35.18743348794305,31.954239448336125,0],[35.18743412934018,31.954238917086574,0],[35.18743460275232,31.954238520745417,0],[35.18743519294548,31.95423802531899,0],[35.18743538428663,31.954237863733734,0],[35.187439104210206,31.954234616784973,0],[35.187442728912394,31.95423126236662,0],[35.18744798136186,31.954226038284816,0],[35.18745300204597,31.954220591641793,0],[35.18746928670545,31.954198888908078,0],[35.18764272623399,31.9542604353598,0],[35.18764290859199,31.95426048414027,0],[35.187643099034815,31.954260503957315,0],[35.187643290375995,31.954260494048793,0],[35.187710196898344,31.954251837807202,0],[35.1877771034207,31.954243182327,0],[35.18786860312059,31.954268701357098,0],[35.18792407229276,31.954284170850844,0],[35.188150530389386,31.954443110296804,0],[35.18815070825581,31.95444321090626,0],[35.18815090588517,31.95444328026584,0],[35.18815111788755,31.954443313040116,0],[35.18815133258493,31.954443309229152,0],[35.18815154099405,31.954443268070726,0],[35.18815173682679,31.954443191851453,0],[35.18828010967417,31.954379076930547,0],[35.188472694098046,31.95428855804024,0],[35.18853593010415,31.954258831702884,0],[35.188536004664314,31.95425879587976,0],[35.18853607383459,31.95425875091028,0],[35.18875175574103,31.954113350026184,0],[35.18882801013225,31.95409312211581,0],[35.188881779691876,31.95407885914597,0],[35.18901116494059,31.95420653219773,0],[35.18912126875,31.954316201292123,0],[35.1891277159588,31.954361644804532,0],[35.189143697886024,31.95446680534444,0],[35.1891753051093,31.95454825702398,0],[35.18922668694692,31.954680542964763,0],[35.18935971127083,31.954801757145805,0],[35.189380710288916,31.95500017705376,0],[35.18941870812711,31.955170801871628,0],[35.189436327683076,31.955248602817516,0],[35.18947003426916,31.955250268956455,0],[35.18955874020855,31.955253918303576,0],[35.18966129727128,31.9554513738336,0],[35.18994959539202,31.95542631091849,0],[35.1899914461045,31.9554222499985,0],[35.19000829310933,31.955291773792805,0],[35.19006354129592,31.954854163780766,0],[35.19056515605902,31.954937778208496,0],[35.190597633749775,31.95492007180053,0],[35.19065301309041,31.95469565568386,0],[35.19125812006245,31.954743939691948,0],[35.19137231479968,31.954487520975658,0],[35.19160282878979,31.954550564179034,0],[35.191749368267146,31.95429759004004,0],[35.192372197203056,31.954497000362785,0],[35.19280176797867,31.9539536447639,0],[35.19298486888808,31.954051116737137,0],[35.19318553635287,31.954165000194113,0],[35.193218060756045,31.954140291348885,0],[35.1932559786442,31.954105737216548,0],[35.19329913730372,31.95405888580152,0],[35.19331929370206,31.954036997815862,0],[35.19342106114566,31.95392678722814,0],[35.193516341854576,31.95381749876786,0],[35.193560724019505,31.953763080099673,0],[35.19362578540228,31.953678905910664,0],[35.19366598501123,31.95362689723556,0],[35.19371563130372,31.953565550055753,0],[35.193770662996336,31.953501185282633,0],[35.19379331671117,31.953475277316866,0],[35.19386531757953,31.953395060214522,0],[35.19393954716809,31.95331551073124,0],[35.19401418189683,31.95323829123317,0],[35.19408061231209,31.953172359140666,0],[35.19411554779348,31.953140668243318,0],[35.194135026862114,31.953124206929918,0],[35.19421803119438,31.953054088729264,0],[35.194247226441114,31.95302569280163,0],[35.19427093387978,31.95299867035831,0],[35.19430300193876,31.952955605013987,0],[35.19432167342197,31.952927322624564,0],[35.19436306240037,31.952849354313827,0],[35.19439633599849,31.952761984878965,0],[35.194459029422156,31.952710451302003,0],[35.19446114944624,31.95270854273514,0],[35.19451568616713,31.95265936587425,0],[35.194531060833214,31.95264154164709,0],[35.19454187565094,31.952624559656226,0],[35.19455148133627,31.952599630880666,0],[35.194556800261054,31.95257007473142,0],[35.19455801837658,31.95253560613799,0],[35.19455532343072,31.952490942224287,0],[35.19455024884768,31.95245738215465,0],[35.19454060633144,31.952421268670662,0],[35.1945262692195,31.952381972183854,0],[35.19450608587168,31.952336321895267,0],[35.19448606422064,31.95229383704496,0],[35.194472125062376,31.952268058314505,0],[35.19445717080783,31.952245788034407,0],[35.19444117271095,31.952227513260212,0],[35.19449353371223,31.95216923914562,0],[35.19454864894816,31.952112990954056,0],[35.19459978824065,31.952064364853992,0],[35.194642689083665,31.95202710103629,0],[35.19469153407894,31.951989113100886,0],[35.19473499277576,31.951957760218146,0],[35.19488144691315,31.952058215322786,0],[35.194946154359705,31.952111850684606,0],[35.19506140461739,31.952207380973228,0],[35.195207043084515,31.952263190073506,0],[35.19547191404099,31.95237502311563,0],[35.19568973842938,31.952500453830208,0],[35.19588217013968,31.952618048875976,0],[35.19599354865847,31.952709433755363,0],[35.19608761484513,31.952869760091996,0],[35.195882870825585,31.95305873817571,0],[35.19583038675513,31.953121450038836,0],[35.19577402914913,31.95318878767065,0],[35.195671381356554,31.953335888966635,0],[35.19557818923067,31.953548267166568,0],[35.1956084588625,31.953715772714958,0],[35.195508046078345,31.95381820837419,0],[35.19526054314958,31.953921826087004,0],[35.19505154740377,31.95402826609579,0],[35.195111677933944,31.95429952067753,0],[35.195271083981126,31.95484416004411,0],[35.19549272800611,31.95494998084914,0],[35.19578743291149,31.95512821619917,0],[35.19589926597784,31.955285795207356,0],[35.195994764079074,31.95552850610667,0],[35.19601003184564,31.955590919032122,0],[35.19606761744861,31.955675618137178,0],[35.19616441720867,31.955862672800876,0],[35.196204233237026,31.955919427070835,0],[35.19625173075936,31.955964365226755,0],[35.19628939083101,31.955983161350886,0],[35.19631825190446,31.955987931835693,0],[35.196364860094654,31.956000552773634,0],[35.1964040302343,31.95598568416681,0],[35.196542024936655,31.956095284065206,0],[35.19647870718387,31.956299950271738,0],[35.19625339533758,31.95636868416803,0],[35.19628085324253,31.95659170827642,0],[35.1961813989608,31.95671322099412,0],[35.19628951120525,31.956703497177788,0],[35.19627115592906,31.956831440963683,0],[35.19621812568287,31.957008312948723,0],[35.196156081741144,31.95726046486282,0],[35.1960774728656,31.957485382316573,0],[35.196050661747634,31.957677593920575,0],[35.19599785787691,31.95783863411765,0],[35.1960023898775,31.957989900049498,0],[35.195917399370146,31.958151586012438,0],[35.195845756929636,31.95827431383749,0],[35.19585218976538,31.95841959000004,0],[35.19584637317391,31.95856662575695,0],[35.19586135078465,31.958643961196493,0],[35.195807888448826,31.958654690093613,0],[35.19580777436279,31.95865471600695,0],[35.19575522561362,31.95866936772892,0],[35.195755136680404,31.958669395166613,0],[35.19570372699501,31.958687920171176,0],[35.195660462334274,31.958706974109298,0],[35.195458680958545,31.95880647294786,0],[35.19545803686646,31.95880679381583,0],[35.19525667230902,31.958908739828466,0],[35.195309821132795,31.959118422360756,0],[35.195313637176135,31.9591669243062,0],[35.19532717658409,31.95931361132515,0],[35.19533988774535,31.959453887655933,0],[35.19537434622134,31.95969188507985,0],[35.195429190166074,31.95971130235478,0],[35.19553616963494,31.95974917429846,0],[35.195548094770345,31.95991347285416,0],[35.195569795372656,31.959965474921002,0],[35.19595599728297,31.959978333102168,0],[35.19597056705856,31.960008530881506,0],[35.19597499126133,31.960056771702863,0],[35.196088301158014,31.96008605411906,0],[35.196065645646556,31.96022526988859,0],[35.19597621386845,31.96036828473329,0],[35.19576490136752,31.960365663721237,0],[35.19551685316139,31.96036451669494,0],[35.1955029131048,31.960509794123876,0],[35.19559857200448,31.960683362765053,0],[35.19578324406732,31.960735224162054,0],[35.19584905733997,31.960724068709183,0],[35.19593674728476,31.960722064279132,0],[35.19593380709884,31.96076079778678,0],[35.1960617101273,31.960762904342825,0],[35.19604400882463,31.960911139003603,0],[35.1960262859624,31.961230105879768,0],[35.196007744734935,31.961359367951026,0],[35.196062852784344,31.961365003942394,0],[35.19614491478386,31.96137166805395,0],[35.19622718609083,31.961374866735923,0],[35.19630951758494,31.961374593891456,0],[35.1965150548169,31.961374619804044,0],[35.19682687712,31.96137465867298,0],[35.1972058197445,31.961396076196866,0],[35.19724787886611,31.961397166812237,0],[35.197307395846934,31.961393849238,0],[35.197307476695336,31.96139384009239,0],[35.19736632443126,31.96138487280979,0],[35.197366388211655,31.96138485909136,0],[35.19742413012148,31.961370319836554,0],[35.19750915835808,31.961356552622682,0],[35.19750949522629,31.96135649088973,0],[35.19759374013196,31.96134026502441,0],[35.19764529264948,31.961328375708366,0],[35.19769626036377,31.96131479368721,0],[35.197696390619484,31.961314754818314,0],[35.19774697475314,31.961299424455326,0],[35.1977968258615,31.96128245397297,0],[35.19783543724904,31.96126249667559,0],[35.19783549384293,31.961262473811512,0],[35.1978556700042,31.96125469011383,0],[35.19787653158003,31.96124834075602,0],[35.197897689599934,31.96124355530174,0],[35.19791924737011,31.961240297930733,0],[35.19791930665892,31.961240291833647,0],[35.1979409452775,31.961238620468446,0],[35.197962673727595,31.96123852520142,0],[35.198005173023674,31.961242937209104,0],[35.1980564488601,31.961245410341707,0],[35.19805649736911,31.961245410341707,0],[35.1981077723072,31.961242082854216,0],[35.19810784507076,31.961242072946458,0],[35.19815834566109,31.961232998949928,0],[35.19815842291621,31.961232979134383,0],[35.19820757513529,31.96121827294763,0],[35.19820761915272,31.961218254656323,0],[35.198254830112475,31.961198092330264,0],[35.198284682926015,31.961179656239885,0],[35.19828474401145,31.96117962270585,0],[35.19831608982497,31.961164011853903,0],[35.19831615270704,31.9611639851791,0],[35.19834878939962,31.961151290261274,0],[35.19839076857117,31.961139724829142,0],[35.19839082606336,31.961139714159206,0],[35.19843378439855,31.961132967719944,0],[35.19843387063681,31.96113296086071,0],[35.19847728621449,31.961131105818477,0],[35.19852072155512,31.96113415970272,0],[35.1987436106451,31.961142325241426,0],[35.19874416760058,31.961142348105543,0],[35.1989674708139,31.961153764158485,0],[35.19919994492795,31.961169100642884,0],[35.199317148123086,31.961175504879982,0],[35.19943446181097,31.961180230128996,0],[35.19943471513588,31.961180240036768,0],[35.199552189622246,31.961183287060148,0],[35.199669708125995,31.961184648236614,0],[35.19966998660376,31.961184648236614,0],[35.19978737036025,31.96118432737695,0],[35.199904730760544,31.96118232295694,0],[35.199904930186534,31.961182316859855,0],[35.200022305858184,31.961178632689975,0],[35.20013959079999,31.961173267245837,0],[35.20013481715258,31.961535309795927,0],[35.20036700290743,31.96158085186239,0],[35.20054407162971,31.961532928127234,0],[35.20062991823153,31.96152316823882,0],[35.20077360465953,31.96150683036918,0],[35.20083859777033,31.961648978197065,0],[35.20090086179932,31.961782788082115,0],[35.200956330971486,31.96191180092073,0],[35.201088453386824,31.961994168937412,0],[35.201135345444676,31.96213216012146,0],[35.20115812312701,31.962264973201247,0],[35.20131591669823,31.962259421861333,0],[35.20148533357093,31.96223198525052,0],[35.20168698379264,31.962199299852944,0],[35.20194246915104,31.962245048888942,0],[35.201861980101576,31.962302344136063,0],[35.20189996895663,31.962377652982646,0],[35.20173315180837,31.96242631096693,0],[35.20169614571024,31.962561855841034,0],[35.201720355307145,31.96272228234681,0],[35.201816504686946,31.962884292263453,0],[35.201942917410356,31.963054789640235,0],[35.20221556598054,31.963001428935378,0],[35.20259248559904,31.962913580637096,0],[35.202769030603505,31.962883591110504,0],[35.20301353944744,31.962837651861857,0],[35.20304289639092,31.96282838825428,0],[35.203143902063154,31.962796514730552,0],[35.203192373359244,31.96278697294378,0],[35.203390529134516,31.96273947129268,0],[35.20351775932485,31.962953893099755,0],[35.20361949083582,31.963131858368534,0],[35.20372852565005,31.963453298987474,0],[35.203854729964334,31.963719869967417,0],[35.20394022442656,31.96387014994318,0],[35.204035656950744,31.963924656362874,0],[35.204127557299266,31.963854609663173,0],[35.20417053809236,31.963837919349213,0],[35.204204223118886,31.963810772051676,0],[35.20424719043722,31.963788891724896,0],[35.20427241692705,31.963769478360557,0],[35.20429678732237,31.963815558896417,0],[35.20443801326482,31.96372644397848,0],[35.20457937305624,31.963942350365215,0],[35.20460993104727,31.964108110771825,0],[35.2046529208235,31.964266162123625,0],[35.204665207979964,31.964485537125867,0],[35.204686940023315,31.964523388047862,0],[35.20496843699907,31.9642426677532,0],[35.20503433201842,31.964332875799073,0],[35.205065330183935,31.96437852622193,0],[35.2050785947074,31.9644042489677,0],[35.20509781056965,31.964462388047263,0],[35.205135413149115,31.964533870096826,0],[35.20531237137865,31.96439700587247,0],[35.205409147782525,31.964619851203665,0],[35.20539402644135,31.964770218872985,0],[35.20527113511382,31.96490103370564,0],[35.20522308961916,31.965014402243625,0],[35.20519849913658,31.965072431193732,0],[35.205261797126454,31.965243723191723,0],[35.205360911845005,31.965369516620893,0],[35.20549286717372,31.9655128717339,0],[35.20553367584046,31.965512566893523,0],[35.205790399077294,31.965467234068676,0],[35.205962384233395,31.96547205817003,0],[35.206111562062716,31.965498759147273,0],[35.20636495344819,31.965541734016963,0],[35.206675702264526,31.965584881863297,0],[35.20681611792659,31.96564487286007,0],[35.206924264307,31.965771651133405,0],[35.20704844381862,31.965925152185786,0],[35.20713677516052,31.96605911892798,0],[35.207249827240695,31.966194432097137,0],[35.20721495374304,31.966279320329473,0],[35.20736006579741,31.96650422407721,0],[35.20724419031228,31.9665686490879,0],[35.20724755001146,31.966598712858037,0],[35.20727669585085,31.966739022261333,0],[35.20732864542373,31.966752469352198,0],[35.20736536585762,31.966740266755565,0],[35.20743033112064,31.966719044049277,0],[35.207471800049085,31.96671365987657,0],[35.207513601354215,31.966712499211965,0],[35.207555304742975,31.9667155742491,0],[35.207614321362186,31.96672449833404,0],[35.20779066604233,31.96675645584838,0],[35.20784838279934,31.96676592025156,0],[35.2078628268108,31.96676819814022,0],[35.20792065585722,31.96677695684639,0],[35.20793512591983,31.96677905869186,0],[35.20800755169128,31.966789038265766,0],[35.20801780955351,31.966789451318764,0],[35.208028067415725,31.966789041314122,0],[35.20802811143319,31.966789036741567,0],[35.208038305515046,31.966787808251876,0],[35.20804831993382,31.966785777281025,0],[35.20804836574791,31.966785765087593,0],[35.2080582517076,31.9667829202041,0],[35.20806779540919,31.966779329996047,0],[35.20808599168357,31.966769854925033,0],[35.20808603570103,31.96676982596556,0],[35.2081024452263,31.966757605081092,0],[35.20810248115892,31.966757570787003,0],[35.20811673921912,31.96674288910986,0],[35.20817005512955,31.966675633052333,0],[35.2082259051874,31.96661046583929,0],[35.20825328404063,31.966584708655336,0],[35.20825331817659,31.966584682744223,0],[35.208283963304204,31.966562986742698,0],[35.2082840163048,31.966562956259,0],[35.20831735098836,31.96654571620666,0],[35.20831739859907,31.966545697154295,0],[35.208352808390956,31.966533229322007,0],[35.20835283264548,31.96653322322528,0],[35.20838964919905,31.96652576614994,0],[35.208449547065584,31.966512579661536,0],[35.2084932123749,31.966497137376635,0],[35.20862329561458,31.966444664224674,0],[35.208795335567906,31.966707566958906,0],[35.20890703478526,31.966938342316592,0],[35.20887821862757,31.9669573259548,0],[35.208885671051185,31.967052536728858,0],[35.20888569081412,31.967052756210283,0],[35.20889675985506,31.96714763080485,0],[35.20889678680451,31.96714783275801,0],[35.20891149042907,31.967242419185606,0],[35.20894848215417,31.967225414745663,0],[35.20899600842258,31.96721044812284,0],[35.20909228895642,31.967184393131124,0],[35.20934453768484,31.967118144876906,0],[35.209903010415495,31.966988957214166,0],[35.21006207240792,31.966926507071644,0],[35.210147845347876,31.967099578133936,0],[35.210206676914154,31.967256741078025,0],[35.21025855192687,31.967499187903964,0],[35.210238624598894,31.967634681088608,0],[35.210258762132625,31.967897773221665,0],[35.2104887038959,31.967897507255376,0],[35.21072012338782,31.967894907034395,0],[35.21091506858427,31.967905624943615,0],[35.21122415012743,31.967871421213356,0],[35.21168066497169,31.968021395658663,0],[35.21189752995937,31.967969034641595,0],[35.212107286578195,31.96792111424064,0],[35.21260184058314,31.96780793600182,0],[35.21282597922969,31.96775663110912,0],[35.2129909772895,31.96780731719127,0],[35.213054589689726,31.967826859255744,0],[35.21320864357443,31.96783579618804,0],[35.213406586448954,31.967845011279195,0],[35.213663877421055,31.96791749206972,0],[35.21389529062477,31.967922690224057,0],[35.21425129656511,31.967923226729056,0],[35.21444876423087,31.968520241292502,0],[35.214481671316385,31.968672135106228,0],[35.21451563661727,31.968820049882986,0],[35.21467608920173,31.968912156327214,0],[35.21471446163741,31.969133730996244,0],[35.214732082091714,31.969293537125782,0],[35.214787677926346,31.969511621366053,0],[35.21484558243122,31.969682415073102,0],[35.21487950910456,31.969856434283248,0],[35.214924596446984,31.970035706066742,0],[35.21495740112456,31.970183335159295,0],[35.215031151012724,31.970426745883145,0],[35.215094452595864,31.970610546229615,0],[35.21505912904226,31.970800150034865,0],[35.21500620928888,31.970948126157626,0],[35.2149133243868,31.971082647204515,0],[35.21470679271983,31.971218499361967,0],[35.2144591451623,31.971348680885782,0],[35.21431910140276,31.97142196363681,0],[35.21416170129364,31.971520416880335,0],[35.214019699206794,31.971622622353756,0],[35.21402982142342,31.971825793106174,0],[35.21399103935597,31.97205276212959,0],[35.21390472473189,31.972194485936072,0],[35.21391043891539,31.972326622243745,0],[35.213940310593536,31.972556818802794,0],[35.213947757627245,31.97275216132816,0],[35.213904653764985,31.972772619836988,0],[35.21380364360116,31.972820564376892,0],[35.21351583057065,31.97289408599531,0],[35.21351593118199,31.973088821220657,0],[35.213530334769246,31.97330109734823,0],[35.21365855580132,31.973576492284593,0],[35.21381785225402,31.973808555735925,0],[35.213981857675435,31.974026105734875,0],[35.214185416817145,31.97429402681108,0],[35.21432293361578,31.974502771207483,0],[35.21440803731083,31.974632365886073,0],[35.21455819969375,31.974849810297158,0],[35.214679203660836,31.975007897259925,0],[35.214863069934886,31.975194024026425,0],[35.215056912898454,31.975375162238578,0],[35.21524842114061,31.975549660633874,0],[35.215482298423154,31.97576919308116,0],[35.2156642440991,31.975958946253655,0],[35.215771545164834,31.9760749018875,0],[35.21565121134098,31.976172422009014,0],[35.215829943743145,31.976353129278067,0],[35.215886722658986,31.97641053535644,0],[35.216059879218236,31.97650961266912,0],[35.21639616444316,31.976673846180137,0],[35.21657884673763,31.97676753200547,0],[35.21675012402128,31.97687622698086,0],[35.21685551616705,31.976914203097195,0],[35.21690122334704,31.97693067310014,0],[35.21720855137876,31.977014483072836,0],[35.217373704847134,31.977063925022872,0],[35.21750151804406,31.977267806110106,0],[35.21761529955624,31.977477897819888,0],[35.217644351970876,31.977522253923986,0],[35.217721933173735,31.97763541180354,0],[35.21782996456981,31.97776760200015,0],[35.21792149840569,31.977872962048362,0],[35.218101932217024,31.97812428780978,0],[35.218315677355726,31.97835679772079,0],[35.21864801268835,31.978582936786,0],[35.21879541814163,31.978670238219955,0],[35.21896840312263,31.978772687950713,0],[35.21929955717068,31.978956885344935,0],[35.2194690171625,31.979027953016047,0],[35.21988415290979,31.97918248115832,0],[35.22003129336006,31.979237841055678,0],[35.22026153965225,31.979268565129004,0],[35.220815405822115,31.979351595740848,0],[35.2211473737438,31.97943053365397,0],[35.22132286592276,31.979471443879863,0],[35.221561186272694,31.979566807786632,0],[35.22198277461866,31.979728794072734,0],[35.222189526372894,31.97986206403009,0],[35.222165526083444,31.980131483647078,0],[35.22214654827476,31.98030635398776,0],[35.22209459870188,31.980617979659986,0],[35.22200065109284,31.980960993745004,0],[35.221837630224975,31.981094069133963,0],[35.2217321787904,31.981211245814148,0],[35.22146312258302,31.981231361836564,0],[35.22132561297089,31.98142984883155,0],[35.22124347191963,31.981545614680478,0],[35.221114386708244,31.98172747336769,0],[35.22112305814569,31.981913786140762,0],[35.22095557714244,31.98207553283713,0],[35.2208043313913,31.9822193502782,0],[35.22061216288742,31.98231580626777,0],[35.22047909364774,31.98235381137341,0],[35.22037468785215,31.98238363071786,0],[35.22011710402926,31.982548982940425,0],[35.21988539078826,31.98269713670611,0],[35.21968957871758,31.98279178178242,0],[35.21950451768419,31.982882054653313,0],[35.21931721176093,31.98292737887776,0],[35.21926549305511,31.983089637344992,0],[35.21926915189325,31.983221809779238,0],[35.21927646867125,31.983521434721055,0],[35.219280973722384,31.98371667923739,0],[35.219259424935345,31.983939594245044,0],[35.21919762533536,31.984133436652204,0],[35.21912068912288,31.984277717940035,0],[35.21898394936694,31.984448125293888,0],[35.218820395798126,31.984553015172356,0],[35.21868453459454,31.98465187568368,0],[35.21844541025244,31.984766000817853,0],[35.21812023359432,31.984917899747753,0],[35.217979548437654,31.984965822703906,0],[35.21783539308907,31.98501853670763,0],[35.21760477309776,31.98510691016141,0],[35.2173840714055,31.985186614204217,0],[35.217131632234256,31.98528055496869,0],[35.216907619351836,31.985327357688842,0],[35.21685662109485,31.985336085670397,0],[35.21665177736229,31.985371143118275,0],[35.21656821068467,31.985385444657418,0],[35.21617870477073,31.985448605317472,0],[35.21588459993998,31.985498372641125,0],[35.215650911303655,31.98553700121502,0],[35.21535671843802,31.985583809899808,0],[35.215220329025044,31.985649746148088,0],[35.215251794314504,31.985836642977894,0],[35.21526816161899,31.985933863953495,0],[35.215316438878965,31.986124473088623,0],[35.215352581696116,31.98628595025863,0],[35.21544065342488,31.98639815787431,0],[35.215529306363635,31.986519788098782,0],[35.21557001172411,31.98665991618825,0],[35.21598578078368,31.98671980274164,0],[35.21630071485094,31.98673099389364,0],[35.21649679731454,31.986735342198287,0],[35.216546204655174,31.986736369272865,0],[35.21669271269148,31.986739413924084,0],[35.21685977957137,31.986742578197433,0],[35.217246816914916,31.986747461372612,0],[35.217492905895455,31.986735529631773,0],[35.21769311791438,31.98672310873363,0],[35.2179499570339,31.98671832765506,0],[35.218193572054126,31.98672446800759,0],[35.21836683910611,31.98672839496814,0],[35.21857598037899,31.986733022137408,0],[35.21853880899083,31.986928323820827,0],[35.218477681330704,31.987220149828453,0],[35.21843538595216,31.987420159896676,0],[35.21832908021979,31.98770816408966,0],[35.21811755032656,31.98777670075465,0],[35.21789953190207,31.98787388234037,0],[35.21767589361713,31.987975709215753,0],[35.217477672264835,31.988056505636326,0],[35.21735031541207,31.988125489284094,0],[35.21750972415417,31.988250085628295,0],[35.2174561117997,31.988473909246647,0],[35.21738977031765,31.988753618287113,0],[35.21708868737379,31.98869883327663,0],[35.21705500683885,31.988905871758384,0],[35.217049375300306,31.988940492793496,0],[35.21720272939741,31.989003181671936,0],[35.2177015701629,31.989213715845057,0],[35.21791106177871,31.989292393083442,0],[35.21816728375563,31.989408754724113,0],[35.21813169879228,31.989587960123924,0],[35.21798867801589,31.989827694265195,0],[35.217870904390566,31.990014265633953,0],[35.21769513103894,31.98998720074431,0],[35.21763748614716,31.98997832463516,0],[35.217453337802134,31.98993814975438,0],[35.217354338067906,31.990202288796894,0],[35.21725352194022,31.99047002397922,0],[35.21717154168738,31.990686605731618,0],[35.21710005824864,31.99087229536996,0],[35.21708014709038,31.99090074587661,0],[35.21700624808182,31.991006342267806,0],[35.21684806643839,31.991183235264508,0],[35.21665650609394,31.991213863149387,0],[35.21656989592415,31.991427909113384,0],[35.21642837443599,31.991621244282793,0],[35.21621995540858,31.99166592420729,0],[35.21602850106535,31.99169116465226,0],[35.21588698496707,31.991585429624614,0],[35.215802154359835,31.99148018284359,0],[35.215632512009996,31.991426513338617,0],[35.21548419835999,31.99138559091993,0],[35.21533035378273,31.99141603893222,0],[35.21514592516331,31.991432894893766,0],[35.21493776485073,31.991451299003792,0],[35.214767386780714,31.991466602236333,0],[35.21457542938091,31.99148257363975,0],[35.21446044771946,31.991583860142594,0],[35.214399467383025,31.99184581012946,0],[35.21431874207666,31.992166270981762,0],[35.21420855113066,31.992360508182113,0],[35.21397327157794,31.99233648311716,0],[35.21371898008058,31.9922801810605,0],[35.213712603838715,31.99208443211943,0],[35.21375877904092,31.99185049113422,0],[35.21377330120583,31.991608018734482,0],[35.213553835595384,31.991585933230258,0],[35.213449014778135,31.9918278792276,0],[35.21317435398172,31.991903601169916,0],[35.213165360947414,31.99198318197782,0],[35.21314936464713,31.992124756150517,0],[35.21309107566331,31.992257054991544,0],[35.21276864964656,31.992290250810704,0],[35.21257498814267,31.99226372676478,0],[35.21229110074997,31.992261806830054,0],[35.21196748985539,31.992250042657947,0],[35.21197971592638,31.992109556643488,0],[35.21199979057806,31.991963098788094,0],[35.21206802121713,31.991794255063038,0],[35.2120917169777,31.991729968899108,0],[35.21211785974909,31.991659049729495,0],[35.21208100007637,31.991530244792138,0],[35.21193977682887,31.99146989434332,0],[35.211768601953146,31.991369963872206,0],[35.21162719005944,31.991297299703326,0],[35.211486217441895,31.99123074505233,0],[35.21132343103434,31.99122360235752,0],[35.21127968936821,31.991301659981744,0],[35.211241279203286,31.99137020310451,0],[35.21114619881867,31.991525787003294,0],[35.211049469127175,31.991712652052655,0],[35.21101606078175,31.991882938932413,0],[35.21095929444234,31.992041174830057,0],[35.21095267296037,31.99216983124526,0],[35.21092134331653,31.992508944758892,0],[35.21066358432218,31.99257271687222,0],[35.21037119976516,31.992589904799267,0],[35.210234622604325,31.99248986507625,0],[35.21016227318966,31.992269488854184,0],[35.209738098593945,31.992336717775647,0],[35.20960368816957,31.99252215798727,0],[35.20929999831473,31.992884847905884,0],[35.209022534774604,31.992829781183826,0],[35.2087916336106,31.99278357198224,0],[35.20842234068889,31.992688045819904,0],[35.20832990314783,31.992662283764567,0],[35.208049976427205,31.992584275296412,0],[35.20797041084586,31.992562181646583,0],[35.20775477565179,31.99250523594255,0],[35.20767849700609,31.99248884568488,0],[35.20760167038803,31.992472338095208,0],[35.207567569441544,31.992459975114585,0],[35.20725470688934,31.99232021625361,0],[35.20716138271107,31.992261552362528,0],[35.207052637154376,31.992202559302047,0],[35.20664921813333,31.992074148258244,0],[35.2062758046394,31.992049973027754,0],[35.205892356065426,31.99202514790656,0],[35.205841712642965,31.99202404165561,0],[35.20575308216207,31.99200023820985,0],[35.205597498446444,31.991951995890773,0],[35.20546411120316,31.99182990202552,0],[35.205231435866494,31.991715132744993,0],[35.205033855013,31.99162579730247,0],[35.20482925202895,31.99150539362616,0],[35.204693924424646,31.99137470204278,0],[35.20457421942146,31.991259583248354,0],[35.20435334794762,31.991130895842655,0],[35.204306894267646,31.99115470027594,0],[35.2042860506581,31.991125885665433,0],[35.204236080972116,31.99116163498068,0],[35.20415346381373,31.991221731161858,0],[35.204113427698154,31.991253839380754,0],[35.2039710671835,31.9913267900534,0],[35.203841195047936,31.991128533227215,0],[35.203749515685,31.990972406189226,0],[35.20360573762882,31.990717661965448,0],[35.20349670101796,31.990562805065586,0],[35.20336513825302,31.990431002059488,0],[35.203268893651796,31.99035048886955,0],[35.20325494012048,31.990312800215346,0],[35.20319234371484,31.99029779697697,0],[35.203078131909635,31.9902830108763,0],[35.20302637816949,31.990283423823556,0],[35.202503034956294,31.990331704353096,0],[35.20243099186714,31.990310938143818,0],[35.2022971707376,31.990249208623734,0],[35.20208533002727,31.990175086821477,0],[35.2020173275603,31.99010890163799,0],[35.201969457237105,31.990120627227945,0],[35.20192964480204,31.99013045569403,0],[35.2018865678892,31.990100747056893,0],[35.20185425099689,31.990036298945657,0],[35.201518082552944,31.989962804775285,0],[35.201374927029256,31.989937079287508,0],[35.20132060680234,31.989922742648677,0],[35.201149929593285,31.98992222989114,0],[35.20083064857838,31.98976484595127,0],[35.20036012810054,31.989614609895355,0],[35.20014178538423,31.989597749790104,0],[35.20013669193656,31.989522220229183,0],[35.200124231405255,31.9894845479965,0],[35.20008343441664,31.989447838792767,0],[35.20002450583231,31.98940050331916,0],[35.199963309900205,31.989360895041102,0],[35.19994290017695,31.989428507807517,0],[35.19989803741334,31.98955685931733,0],[35.19987839934292,31.989630090195277,0],[35.19983078234465,31.989650356751984,0],[35.19959293720352,31.989774052745503,0],[35.19926452840701,31.98973870517254,0],[35.19923397311093,31.98988786827209,0],[35.19921137688827,31.989998175118803,0],[35.19919652863495,31.990054896857767,0],[35.199165571791944,31.990167864807283,0],[35.19913286323413,31.990280476812487,0],[35.1991327796908,31.99028075795192,0],[35.19909836163901,31.990392866206395,0],[35.19906219456737,31.99050457813927,0],[35.19902613439522,31.99064666810958,0],[35.198993465363266,31.99078957613082,0],[35.1989642081328,31.990933222200713,0],[35.19894493837163,31.99109338502913,0],[35.19892982242034,31.991253994043873,0],[35.1989188701604,31.99141494029273,0],[35.19888070343892,31.99140777170818,0],[35.198796765757095,31.991379942296035,0],[35.19842245035461,31.991325321897882,0],[35.19827438104634,31.99128777764084,0],[35.197687676062905,31.99117123019749,0],[35.19765104096898,31.991164386920047,0],[35.19762606960073,31.99127802472556,0],[35.197586512287174,31.991282980800502,0],[35.197542555923704,31.99149631119304,0],[35.19748891033157,31.991687995216456,0],[35.197249326950356,31.991785258751264,0],[35.197201661443074,31.991758089244346,0],[35.1971704961909,31.991717973808132,0],[35.19710817017818,31.991704793986823,0],[35.19708066735745,31.99168911594725,0],[35.19695923399564,31.991601743855313,0],[35.19682741790579,31.99149925435555,0],[35.1965352318765,31.99152710963555,0],[35.196287969696236,31.99152039895268,0],[35.19609162941616,31.9915255988177,0],[35.19592810639002,31.991558702713522,0],[35.195804208051115,31.99157594873377,0],[35.1956856780443,31.991592449627877,0],[35.195439357298454,31.991646240937204,0],[35.19519228735766,31.991781776946794,0],[35.19500325038086,31.991923867224234,0],[35.19492271731393,31.9920405142795,0],[35.19488838639873,31.992230787689255,0],[35.19489088281689,31.99246191409205,0],[35.194853789582176,31.992621115811307,0],[35.19482103610861,31.992779018258137,0],[35.19479158124875,31.992997141921993,0],[35.19473236610188,31.993217691625965,0],[35.194628759806875,31.993396037814154,0],[35.19455489583263,31.993557668271173,0],[35.194465198153225,31.993719123975936,0],[35.1943980580689,31.99385132528399,0],[35.19430487312951,31.99398887773786,0],[35.19424926202354,31.994115798181685,0],[35.19414127374659,31.994273426832258,0],[35.19408961343124,31.994389327322857,0],[35.194070696707996,31.994431765266228,0],[35.193993196353475,31.99456137522391,0],[35.193567510791475,31.994472233018797,0],[35.193402771446465,31.99445049866015,0],[35.19320106732582,31.99442388686308,0],[35.193040389264226,31.99452197792411,0]]] // ضع باقي الإحداثيات هنا
        },
        "properties": {"name": "بيرزيت"}
    }]
};
// إضافة هذه الدالة
function clipMapToBirzeit() {
    // إضافة مصدر حدود بيرزيت
    map.addSource('birzeit-clip', {
        'type': 'geojson',
        'data': birzeitBoundary
    });

    // إضافة طبقة لإخفاء كل شيء خارج المنطقة
    map.addLayer({
        'id': 'world-mask',
        'type': 'fill',
        'source': {
            'type': 'geojson',
            'data': {
                'type': 'Feature',
                'geometry': {
                    'type': 'Polygon',
                    'coordinates': [
                        // المربع الكبير (العالم كله)
                        [[-180, -85], [180, -85], [180, 85], [-180, 85], [-180, -85]],
                        // المنطقة المستثناة (بيرزيت) - عكس الاتجاه
                        birzeitBoundary.features[0].geometry.coordinates[0].slice().reverse()
                    ]
                }
            }
        },
        'paint': {
            'fill-color': '#f0f0f0', // لون رمادي فاتح
            'fill-opacity': 1
        }
    });

    // إضافة خط حدود المنطقة
    map.addLayer({
        'id': 'birzeit-border',
        'type': 'line',
        'source': 'birzeit-clip',
        'paint': {
            'line-color': '#333333',
            'line-width': 2,
            'line-opacity': 0.8
        }
    });
}
        // إنشاء الخريطة
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mohammed-1331/cmbseyy16010101qwf9d5a8m3',
            center: ramallahCenter,
            zoom: 14
        });
        
        // نقاط مهمة في رام الله للدورية
        const importantPoints = [
            [35.1953921, 31.9721216], 
            [35.1918355, 31.9632016], 
            [35.1849755, 31.9617697], 
            [35.1965361, 31.9777501], 
            [35.1934147, 31.9690175], 
            [35.2023592, 31.9693232], //بيزريت 
        ];

        // ==================== تعديل: إضافة متغيرات جديدة لكل تكسي ====================
        // بيانات التكاسي
        let taxis = [
            { 
                id: 1, 
                name: 'تاكسي الزيتونة', 
                coordinates: [35.2023592, 31.9693232], 
                status: 'متاح', 
                color: '#f39c12',
                isMoving: false,
                currentRoute: null,
                routeIndex: 0,
                targetPoint: null,
                patrolIndex: 0,
                // ========== إضافة جديدة: متغيرات للتحكم الدقيق بالسرعة ==========
                totalDuration: 0,      // المدة الكاملة للرحلة (بالثواني)
                startTime: null,       // وقت بداية الرحلة
                updateInterval: null,  // فترة التحديث المخصصة لهذا التكسي
                remainingTime: 0       // الوقت المتبقي للوصول
                // ========== نهاية الإضافة الجديدة ==========
            },
            { 
                id: 2, 
                name: 'تاكسي الشهد', 
                coordinates: [35.1953921, 31.9721216], 
                status: 'متاح', 
                color: '#e74c3c',
                isMoving: false,
                currentRoute: null,
                routeIndex: 0,
                targetPoint: null,
                patrolIndex: 1,
                // ========== إضافة جديدة: متغيرات للتحكم الدقيق بالسرعة ==========
                totalDuration: 0,
                startTime: null,
                updateInterval: null,
                remainingTime: 0
                // ========== نهاية الإضافة الجديدة ==========
            },
            { 
                id: 3, 
                name: 'تاكسي الشهد', 
                coordinates: [35.1918355, 31.9632016], 
                status: 'متاح', 
                color: '#9b59b6',
                isMoving: false,
                currentRoute: null,
                routeIndex: 0,
                targetPoint: null,
                patrolIndex: 2,
                // ========== إضافة جديدة: متغيرات للتحكم الدقيق بالسرعة ==========
                totalDuration: 0,
                startTime: null,
                updateInterval: null,
                remainingTime: 0
                // ========== نهاية الإضافة الجديدة ==========
            },
            { 
                id: 4, 
                name: ' تاكسي الزيتونة', 
                coordinates: [35.1965361, 31.9777501], 
                status: 'متاح', 
                color: '#1abc9c',
                isMoving: false,
                currentRoute: null,
                routeIndex: 0,
                targetPoint: null,
                patrolIndex: 3,
                // ========== إضافة جديدة: متغيرات للتحكم الدقيق بالسرعة ==========
                totalDuration: 0,
                startTime: null,
                updateInterval: null,
                remainingTime: 0
                // ========== نهاية الإضافة الجديدة ==========
            },
            { 
                id: 5, 
                name: 'تاكسي الزيتونة', 
                coordinates: [35.2023592, 31.9693232], 
                status: 'متاح', 
                color: '#34495e',
                isMoving: false,
                currentRoute: null,
                routeIndex: 0,
                targetPoint: null,
                patrolIndex: 4,
                // ========== إضافة جديدة: متغيرات للتحكم الدقيق بالسرعة ==========
                totalDuration: 0,
                startTime: null,
                updateInterval: null,
                remainingTime: 0
                // ========== نهاية الإضافة الجديدة ==========
            }
        ];
        // ==================== نهاية التعديل ====================
        
        let userLocation = null;
        let nearestTaxi = null;
        let movementIntervals = [];
        let patrolMode = false;
        // دوال التحكم بالهاتف
function togglePanel() {
    if (window.innerWidth <= 480) {
        const panel = document.getElementById('controlPanel');
        panel.classList.toggle('expanded');
    }
}

function updateEmergencyButton() {
    const emergencyBtn = document.querySelector('.emergency-btn');
    if (window.innerWidth <= 480) {
        emergencyBtn.style.display = 'flex';
    } else {
        emergencyBtn.style.display = 'none';
    }
}

window.addEventListener('resize', updateEmergencyButton);
        // إضافة التكاسي للخريطة
        function addTaxisToMap() {
            taxis.forEach(taxi => {
                const el = document.createElement('div');
                el.innerHTML = '🚕';
                el.style.fontSize = '24px';
                el.style.cursor = 'pointer';
                el.style.filter = `hue-rotate(${getHueRotation(taxi.color)}deg)`;
                
                const marker = new mapboxgl.Marker(el)
                    .setLngLat(taxi.coordinates)
                    .setPopup(new mapboxgl.Popup().setHTML(`
                        <h4>${taxi.name}</h4>
                        <p>الحالة: ${taxi.status}</p>
                        <p>المعرف: ${taxi.id}</p>
                        ${taxi.isMoving ? '<p style="color: #e74c3c;">🚗 في الطريق</p>' : ''}
                    `))
                    .addTo(map);
                
                taxi.marker = marker;
            });
            
            updateTaxiList();
        }
        
        // حساب دوران اللون
        function getHueRotation(color) {
            const colorMap = {
                '#f39c12': 0,    // أصفر
                '#e74c3c': 120,  // أحمر
                '#9b59b6': 240,  // بنفسجي
                '#1abc9c': 180,  // فيروزي
                '#34495e': 60    // رمادي
            };
            return colorMap[color] || 0;
        }
        
        // الحصول على مسار من Mapbox Directions API
        async function getRoute(start, end) {
    try {
        const profile = 'driving'; // يمكنك تغييره إلى 'driving-traffic' إذا أردت مراعاة حركة المرور
        const url = `https://api.mapbox.com/directions/v5/mapbox/${profile}/${start[0]},${start[1]};${end[0]},${end[1]}?` +
            new URLSearchParams({
                steps: 'true',
                geometries: 'geojson',
                overview: 'full',               // ✅ يعطيك المسار كامل ودقيق
                access_token: mapboxgl.accessToken,
                annotations: 'duration,distance,speed' // ✅ بيانات إضافية قد تفيد لاحقًا
            });

        const response = await fetch(url);
        
        if (!response.ok) {
            throw new Error('فشل في الاتصال بخدمة الاتجاهات');
        }

        const data = await response.json();

        if (data.routes && data.routes.length > 0) {
            const route = data.routes[0];
            return {
                route: route.geometry.coordinates,  // ✅ المسار كإحداثيات دقيقة
                duration: route.duration,           // ✅ المدة بالثواني
                distance: route.distance            // ✅ المسافة بالأمتار
            };
        } else {
            throw new Error('لم يتم العثور على أي مسار');
        }
    } catch (error) {
        console.error('حدث خطأ أثناء جلب المسار:', error);
        return null;
    }
}

        async function calculateAllRealDistances() {
    if (!userLocation) {
        alert('حدد موقعك أولاً');
        return;
    }
    
    document.getElementById('status').innerHTML = 
        '<div class="status loading">🔄 جاري حساب المسافات الحقيقية... <span class="loading-spinner"></span></div>';
    
    for (let taxi of taxis) {
        if (taxi.status === 'متاح' && !taxi.isMoving) {
            const routeData = await getRoute(taxi.coordinates, userLocation);
            if (routeData) {
                taxi.cachedNetworkDistance = routeData.distance / 1000;
            }
            await new Promise(resolve => setTimeout(resolve, 300));
        }
    }
    
    updateTaxiListWithStats();
    document.getElementById('status').innerHTML = 
        '<div class="status success">✅ تم حساب المسافات الحقيقية</div>';
}
        // ==================== تعديل: تحديث قائمة التكاسي مع عرض الوقت المتبقي ====================
        // تحديث قائمة التكاسي
        function updateTaxiListWithStats() {
    const taxiList = document.getElementById('taxiList');
    const statsHTML = showTaxiStats();
    
    const taxiHTML = taxis.map(taxi => {
        // ========== تعديل حساب المسافة ==========
        let distance = 'غير محدد';
        
        if (userLocation) {
            const euclideanDistance = calculateDistance(userLocation, taxi.coordinates);
            
            if (taxi.isMoving && taxi.actualNetworkDistance && taxi.targetPoint === userLocation) {
                distance = `🛣️ ${taxi.actualNetworkDistance.toFixed(1)} كم`;
            } 
            else if (taxi.cachedNetworkDistance) {
                distance = `🛣️ ${taxi.cachedNetworkDistance.toFixed(1)} كم`;
            } 
            else {
                distance = `✈️ ${taxi.actualNetworkDistance.toFixed(1)} كم`;
            }
        }
        
        const isNearest = nearestTaxi && nearestTaxi.id === taxi.id;
        
        // ========== إضافة العد التنازلي ==========
        let etaInfo = '';
        if (taxi.isMoving && taxi.remainingTime > 0 && taxi.targetPoint === userLocation) {
            const minutes = Math.floor(taxi.remainingTime / 60);
            const seconds = Math.floor(taxi.remainingTime % 60);
            
            etaInfo = `<div class="eta-info">⏱️ الوصول خلال: ${minutes}:${seconds.toString().padStart(2, '0')}</div>`;
        }
        
        let statusIcon = '';
        switch(taxi.status) {
            case 'متاح': statusIcon = '✅'; break;
            case 'في الطريق': statusIcon = '🚗'; break;
            case 'دورية': statusIcon = '🔄'; break;
            default: statusIcon = '❓';
        }
        
        return `
            <div class="taxi-info ${isNearest ? 'nearest-taxi' : ''} ${taxi.isMoving ? 'taxi-moving' : ''}">
                <strong>${taxi.name}</strong>
                ${etaInfo}
                ${isNearest ? '<br><strong>🎯 الأقرب إليك</strong>' : ''}
                <br>الحالة: ${statusIcon} ${taxi.status}<br>
                المسافة: ${distance}
                <div class="taxi-controls">
                    <button class="btn" onclick="moveToLocation(${taxi.id})" ${taxi.isMoving ? 'disabled' : ''}>
                        ${taxi.isMoving ? '⏳ يتحرك' : '📍 اذهب إلي'}
                    </button>
                    <button class="btn" onclick="trackTaxi(${taxi.id})" style="background: #9b59b6;">
                        👁️ تتبع
                    </button>
                </div>
            </div>
        `;
    }).join('');
    
    taxiList.innerHTML = `
        <h4 style="margin-top: 15px; color: #2c3e50;">التكاسي المتاحة:</h4>
        ${statsHTML}
        ${taxiHTML}
    `;
}
        // ==================== نهاية التعديل ====================
        
        // العثور على الموقع الحالي
        function findMyLocation() {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = '<div class="status loading">جاري تحديد موقعك... <span class="loading-spinner"></span></div>';
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = [position.coords.longitude, position.coords.latitude];
                        addUserMarker();
                        statusDiv.innerHTML = '<div class="status success">✅ تم تحديد موقعك بنجاح ✅</div>';
                        document.getElementById('nearestBtn').disabled = false;
                        updateTaxiList();
                    },
                    (error) => {
                        // استخدام موقع افتراضي
                        userLocation = ramallahCenter;
                        addUserMarker();
                        statusDiv.innerHTML = '<div class="status success">✅ تم استخدام موقع افتراضي في بيرزيت </div>';
                        document.getElementById('nearestBtn').disabled = false;
                        updateTaxiList();
                    }
                );
            } else {
                userLocation = ramallahCenter;
                addUserMarker();
                statusDiv.innerHTML = '<div class="status success">✅ تم استخدام موقع افتراضي</div>';
                document.getElementById('nearestBtn').disabled = false;
                updateTaxiList();
            }
        }
        
        // إضافة علامة المستخدم
        function addUserMarker() {
            if (window.userMarker) {
                window.userMarker.remove();
            }
            
            const userEl = document.createElement('div');
            userEl.innerHTML = '📍';
            userEl.style.fontSize = '28px';
            
            window.userMarker = new mapboxgl.Marker(userEl)
                .setLngLat(userLocation)
                .setPopup(new mapboxgl.Popup().setHTML('<h4>موقعك الحالي</h4>'))
                .addTo(map);
            
            map.flyTo({
                center: userLocation,
                zoom: 15
            });
        }
        
        // حساب المسافة بين نقطتين
        function calculateDistance(point1, point2) {
            const lat1 = point1[1];
            const lon1 = point1[0];
            const lat2 = point2[1];
            const lon2 = point2[0];
            
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }
        
        // العثور على أقرب تكسي
        // العثور على أقرب تكسي - تحليل الشبكات
async function findNearestTaxi() {
    // استخدام تحليل الشبكات بدلاً من المسافة الهوائية
    return await findNearestTaxiByNetwork();
}

// دالة تحليل الشبكات الجديدة
async function findNearestTaxiByNetwork() {
    if (!userLocation) {
        alert('يرجى تحديد موقعك أولاً');
        return;
    }

    document.getElementById('status').innerHTML = 
        '<div class="status loading">🛣️ جاري البحث عن أقرب تكسي عبر الشوارع... <span class="loading-spinner"></span></div>';

    let shortestRoute = null;
    nearestTaxi = null;
    let shortestTime = Infinity;

    // فحص كل تكسي متاح
    for (let taxi of taxis) {
        if (taxi.status === 'متاح' && !taxi.isMoving) {
            
            console.log(`🚕 فحص ${taxi.name}...`);
            
            // حساب المسار الفعلي عبر شبكة الطرق
            const routeData = await getRoute(taxi.coordinates, userLocation);
            
            if (routeData) {
                console.log(`📊 ${taxi.name}: ${Math.round(routeData.duration/60)} دقيقة, ${(routeData.distance/1000).toFixed(1)} كم`);
                
                // إذا هذا المسار أسرع
                if (routeData.duration < shortestTime) {
                    shortestTime = routeData.duration;
                    shortestRoute = routeData;
                    nearestTaxi = taxi;
                }
            } else {
                console.log(`❌ ${taxi.name}: لا يمكن الوصول إليه`);
            }
            
            // تأخير صغير لتجنب الضغط على الخدمة
            await new Promise(resolve => setTimeout(resolve, 300));
        }
    }

    // عرض النتائج
    if (nearestTaxi && shortestRoute) {
        document.getElementById('status').innerHTML = `
            <div class="status success">
                ✅ أقرب تكسي (تحليل شبكات): <strong>${nearestTaxi.name}</strong><br>
                ⏱️ وقت الوصول: <strong>${Math.round(shortestRoute.duration/60)} دقيقة</strong><br>
                📏 المسافة عبر الشوارع: <strong>${(shortestRoute.distance/1000).toFixed(1)} كم</strong>
            </div>
        `;
        
        // رسم المسار على الخريطة
        drawNetworkRoute(nearestTaxi, shortestRoute);
        
        // التركيز على التكسي
        map.flyTo({
            center: nearestTaxi.coordinates,
            zoom: 14
        });
        
        // تفعيل زر الاستدعاء
        document.getElementById('callBtn').disabled = false;
        updateTaxiList();
        
    } else {
        document.getElementById('status').innerHTML = 
            '<div class="status error">❌ لا يمكن الوصول لأي تكسي عبر الطرق المتاحة</div>';
    }
    
    return nearestTaxi;
}

// دالة رسم المسار على الخريطة
function drawNetworkRoute(taxi, routeData) {
    const routeId = `network-route-${taxi.id}`;
    
    // إزالة المسار السابق
    if (map.getSource(routeId)) {
        map.removeLayer(routeId);
        map.removeSource(routeId);
    }
    
    // إضافة المسار الجديد
    map.addSource(routeId, {
        'type': 'geojson',
        'data': {
            'type': 'Feature',
            'properties': {},
            'geometry': {
                'type': 'LineString',
                'coordinates': routeData.route
            }
        }
    });
    
    map.addLayer({
        'id': routeId,
        'type': 'line',
        'source': routeId,
        'layout': {
            'line-join': 'round',
            'line-cap': 'round'
        },
        'paint': {
            'line-color': '#27ae60',    // أخضر للشبكة
            'line-width': 4,
            'line-opacity': 0.8
        }
    });

            
            // ========== تعديل: تحديث بيانات التكسي مع المعلومات الجديدة ==========
            taxi.isMoving = true;
            taxi.status = 'في الطريق';
            taxi.currentRoute = routeData.route;
            taxi.routeIndex = 0;
            taxi.totalDuration = routeData.duration; // المدة الفعلية بالثواني من Mapbox
            taxi.remainingTime = routeData.duration;
            taxi.startTime = Date.now(); // وقت بداية الرحلة
            taxi.targetPoint = userLocation;
            taxi.actualNetworkDistance = routeData.distance / 1000; // ← المسافة الحقيقية

            // ========== نهاية التعديل ==========
            
            // رسم المسار على الخريطة
            drawRoute(taxi);
            
            // ========== تعديل: بدء تحريك التكسي بالسرعة الحقيقية ==========
            startTaxiMovementWithRealSpeed(taxi);
            // ========== نهاية التعديل ==========
            
            // حساب المسافة الصحيحة
const euclideanDistance = calculateDistance(taxi.coordinates, userLocation);
const networkDistance = routeData.distance / 1000;
const travelTime = Math.ceil(routeData.duration / 60);

document.getElementById('status').innerHTML = 
    `<div class="status success">
        ✅ <strong>${taxi.name}</strong> في الطريق إليك!<br>
        🛣️ <strong>المسار عبر الشوارع:</strong> ${networkDistance.toFixed(1)} كم<br>
        ⏱️ <strong>وقت الوصول:</strong> ${travelTime} دقيقة<br>
        <small style="color: #7f8c8d;">
            📏 المسافة الهوائية: ${euclideanDistance.toFixed(1)} كم | 
            الفرق: +${(networkDistance - euclideanDistance).toFixed(1)} كم عبر الطرق
        </small>
    </div>`;
            
            updateTaxiList();
        }
        
        // ========== إضافة جديدة: دالة تحريك التكسي بالسرعة الحقيقية ==========
        function startTaxiMovementWithRealSpeed(taxi) {
            // إيقاف أي حركة سابقة
            if (taxi.updateInterval) {
                clearInterval(taxi.updateInterval);
            }
            
            const route = taxi.currentRoute;
            const totalPoints = route.length;
            const totalDuration = taxi.totalDuration; // بالثواني
            
            // حساب الفترة الزمنية بين كل نقطة (بالميلي ثانية)
            // هذا يضمن أن التكسي سيصل في الوقت المحدد تماماً
            const updateInterval = (totalDuration * 1000) / totalPoints;
            
            let currentIndex = taxi.routeIndex;
            
            taxi.updateInterval = setInterval(() => {
                if (!taxi.isMoving || !taxi.currentRoute) {
                    clearInterval(taxi.updateInterval);
                    return;
                }
                
                currentIndex++;
                
                if (currentIndex >= totalPoints) {
                    // وصل التكسي للهدف
                    taxi.isMoving = false;
                    taxi.status = 'وصل';
                    taxi.currentRoute = null;
                    taxi.routeIndex = 0;
                    taxi.remainingTime = 0;
                    
                    // إزالة المسار من الخريطة
                    const routeId = `route-${taxi.id}`;
                    if (map.getSource(routeId)) {
                        map.removeLayer(routeId);
                        map.removeSource(routeId);
                    }
                    
                    document.getElementById('status').innerHTML = 
                        `<div class="status success">✅ ${taxi.name} وصل إلى موقعك!</div>`;
                    
                    // إضافة مؤثرات بصرية
                    celebrateArrival(taxi);
                    
                    // إعادة تعيين الحالة بعد 5 ثوان
                    setTimeout(() => {
                        taxi.status = 'متاح';
                        updateTaxiList();
                    }, 5000);
                    
                    clearInterval(taxi.updateInterval);
                    updateTaxiList();
                    return;
                }
                
                // تحديث موقع التكسي
                const nextPoint = route[currentIndex];
                if (nextPoint) {
                    taxi.coordinates = [nextPoint[0], nextPoint[1]];
                    taxi.marker.setLngLat(taxi.coordinates);
                    taxi.routeIndex = currentIndex;
                    
                    // حساب الوقت المتبقي بدقة
                    const elapsedTime = (Date.now() - taxi.startTime) / 1000;
                    taxi.remainingTime = Math.max(0, taxi.totalDuration - elapsedTime);
                }
                
                updateTaxiList();
            }, updateInterval); // استخدام الفترة المحسوبة
        }
        // ========== نهاية الإضافة الجديدة ==========
        // ==================== نهاية التعديل الكامل ====================
        
        // رسم المسار على الخريطة
        function drawRoute(taxi) {
            const routeId = `route-${taxi.id}`;
            
            // إزالة المسار السابق إن وجد
            if (map.getSource(routeId)) {
                map.removeLayer(routeId);
                map.removeSource(routeId);
            }
            
            map.addSource(routeId, {
                'type': 'geojson',
                'data': {
                    'type': 'Feature',
                    'properties': {},
                    'geometry': {
                        'type': 'LineString',
                        'coordinates': taxi.currentRoute
                    }
                }
            });
            
            map.addLayer({
                'id': routeId,
                'type': 'line',
                'source': routeId,
                'layout': {
                    'line-join': 'round',
                    'line-cap': 'round'
                },
                'paint': {
                    'line-color': '#e74c3c',
                    'line-width': 4,
                    'line-opacity': 0.8
                }
            });
        }
        
        // ==================== تعديل: دالة الحركة القديمة - تم استبدالها بالدالة الجديدة ====================
        // تحريك التكسي على المسار (الدالة القديمة - لم تعد مستخدمة)
        function startTaxiMovement(taxi) {
            // هذه الدالة القديمة التي كانت تتحرك بخطوة واحدة كل ثانية
            // تم استبدالها بـ startTaxiMovementWithRealSpeed للحصول على سرعة حقيقية
            
            /* الكود القديم:
            const moveStep = () => {
                if (!taxi.isMoving || !taxi.currentRoute) {
                    return;
                }
                
                const route = taxi.currentRoute;
                const currentIndex = taxi.routeIndex;
                
                if (currentIndex >= route.length - 1) {
                    // وصل التكسي للهدف
                    // ... باقي الكود
                }
                
                // تحديث موقع التكسي
                const nextPoint = route[currentIndex + 1];
                if (nextPoint) {
                    taxi.coordinates = [nextPoint[0], nextPoint[1]];
                    taxi.marker.setLngLat(taxi.coordinates);
                    taxi.routeIndex++;
                    
                    // تحديث الوقت المتبقي (غير دقيق)
                    const remainingPoints = route.length - taxi.routeIndex;
                    const totalPoints = route.length;
                    taxi.routeETA = taxi.routeETA * (remainingPoints / totalPoints);
                }
                
                updateTaxiList();
                
                // الخطوة التالية (كل ثانية - غير مناسب للسرعة الحقيقية)
                setTimeout(moveStep, 1000);
            };
            
            moveStep();
            */
        }
        // ==================== نهاية التعديل ====================
        
        // وضع الدورية
        async function startPatrolMode() {
            if (patrolMode) {
                return;
            }
            
            patrolMode = true;
            document.getElementById('status').innerHTML = 
                '<div class="status success">🚗 تم تشغيل وضع الدورية</div>';
            
            // تحريك كل تكسي في دورية
            for (let taxi of taxis) {
                if (!taxi.isMoving) {
                    await startTaxiPatrol(taxi);
                }
            }
        }
        
        // ==================== تعديل: دورية فردية للتكسي مع السرعة الحقيقية ====================
        // دورية فردية للتكسي
        async function startTaxiPatrol(taxi) {
            if (taxi.isMoving) return;
            
            const getNextPatrolPoint = () => {
                taxi.patrolIndex = (taxi.patrolIndex + 1) % importantPoints.length;
                return importantPoints[taxi.patrolIndex];
            };
            
            const patrolStep = async () => {
                if (!patrolMode || taxi.isMoving) {
                    return;
                }
                
                const nextPoint = getNextPatrolPoint();
                const routeData = await getRoute(taxi.coordinates, nextPoint);
                
                if (routeData) {
                    // ========== تعديل: استخدام المتغيرات الجديدة للدورية ==========
                    taxi.isMoving = true;
                    taxi.status = 'دورية';
                    taxi.currentRoute = routeData.route;
                    taxi.routeIndex = 0;
                    taxi.totalDuration = routeData.duration;
                    taxi.remainingTime = routeData.duration;
                    taxi.startTime = Date.now();
                    // ========== نهاية التعديل ==========
                    
                    // ========== تعديل: استخدام الدالة الجديدة للحركة ==========
                    startPatrolMovementWithRealSpeed(taxi, patrolStep);
                    // ========== نهاية التعديل ==========
                }
            };
            
            // بدء الدورية مع تأخير عشوائي لكل تكسي
            setTimeout(patrolStep, Math.random() * 3000);
        }
        
        // ========== إضافة جديدة: حركة الدورية بالسرعة الحقيقية ==========
        function startPatrolMovementWithRealSpeed(taxi, continuePatrol) {
            // إيقاف أي حركة سابقة
            if (taxi.updateInterval) {
                clearInterval(taxi.updateInterval);
            }
            
            const route = taxi.currentRoute;
            const totalPoints = route.length;
            const totalDuration = taxi.totalDuration;
            
            // حساب الفترة الزمنية بين كل نقطة للدورية
            const updateInterval = (totalDuration * 1000) / totalPoints;
            let currentIndex = taxi.routeIndex;
            
            taxi.updateInterval = setInterval(() => {
                if (!patrolMode || !taxi.currentRoute) {
                    clearInterval(taxi.updateInterval);
                    taxi.isMoving = false;
                    taxi.status = 'متاح';
                    return;
                }
                
                currentIndex++;
                
                if (currentIndex >= totalPoints) {
                    // وصل للنقطة، انتظار ثم الانتقال للنقطة التالية
                    taxi.isMoving = false;
                    taxi.status = 'متاح';
                    taxi.currentRoute = null;
                    taxi.routeIndex = 0;
                    taxi.remainingTime = 0;
                    
                    clearInterval(taxi.updateInterval);
                    
                    // انتظار 5 ثوان ثم البدء مرة أخرى
                    setTimeout(() => {
                        if (patrolMode) {
                            continuePatrol();
                        }
                    }, 5000);
                    
                    updateTaxiList();
                    return;
                }
                
                // تحديث الموقع
                const nextPoint = route[currentIndex];
                if (nextPoint) {
                    taxi.coordinates = [nextPoint[0], nextPoint[1]];
                    taxi.marker.setLngLat(taxi.coordinates);
                    taxi.routeIndex = currentIndex;
                    
                    // تحديث الوقت المتبقي للدورية
                    const elapsedTime = (Date.now() - taxi.startTime) / 1000;
                    taxi.remainingTime = Math.max(0, taxi.totalDuration - elapsedTime);
                }
                
                updateTaxiList();
            }, updateInterval);
        }
        // ========== نهاية الإضافة الجديدة ==========
        // ==================== نهاية التعديل ====================
        
        // ==================== تعديل: إيقاف جميع التكاسي مع تنظيف المتغيرات الجديدة ====================
        // إيقاف جميع التكاسي
        function stopAllTaxis() {
            patrolMode = false;
            
            taxis.forEach(taxi => {
                // ========== إضافة: تنظيف المتغيرات الجديدة ==========
                if (taxi.updateInterval) {
                    clearInterval(taxi.updateInterval);
                }
                // ========== نهاية الإضافة ==========
                
                taxi.isMoving = false;
                taxi.status = 'متاح';
                taxi.currentRoute = null;
                taxi.routeIndex = 0;
                taxi.remainingTime = 0; // إضافة جديدة
                
                // إزالة المسار من الخريطة
                const routeId = `route-${taxi.id}`;
                if (map.getSource(routeId)) {
                    map.removeLayer(routeId);
                    map.removeSource(routeId);
                }
            });
            
            document.getElementById('status').innerHTML = 
                '<div class="status success"> تم إيقاف جميع التكاسي</div>';
            
            updateTaxiList();
        }
        // ==================== نهاية التعديل ====================
        
        // إضافة نقاط الدورية للخريطة
        function addPatrolPoints() {
            importantPoints.forEach((point, index) => {
                const el = document.createElement('div');
                el.innerHTML = '⭐ ';
                el.style.fontSize = '16px';
                el.style.opacity = '0.6';
                
                new mapboxgl.Marker(el)
                    .setLngLat(point)
                    .setPopup(new mapboxgl.Popup().setHTML(`<h4>نقطة دورية ${index + 1}</h4>`))
                    .addTo(map);
            });
        }
        
        // عرض إحصائيات التكاسي
        function showTaxiStats() {
            const available = taxis.filter(t => t.status === 'متاح' && !t.isMoving).length;
            const moving = taxis.filter(t => t.isMoving).length;
            const total = taxis.length;
            
            return `
                <div style="background: #ecf0f1; padding: 10px; border-radius: 8px; margin: 10px 0; text-align: center;">
                    <strong>إحصائيات التكاسي</strong><br>
                    📊 المجموع: ${total} | ✅ متاح: ${available} | 🚗 يتحرك: ${moving}
                </div>
            `;
        }
        
        // تحديث قائمة التكاسي مع الإحصائيات
        // تحديث قائمة التكاسي مع الإحصائيات
function updateTaxiListWithStats() {
    const taxiList = document.getElementById('taxiList');
    const statsHTML = showTaxiStats();
    
    const taxiHTML = taxis.map(taxi => {
        // ========== تعديل حساب المسافة ==========
        let distance = 'غير محدد';

        if (userLocation) {
            const euclideanDistance = calculateDistance(userLocation, taxi.coordinates);
            
            // إذا التكسي يتحرك إليك ولديه مسافة حقيقية
            if (taxi.isMoving && taxi.actualNetworkDistance && taxi.targetPoint === userLocation) {
                distance = `🛣️ ${taxi.actualNetworkDistance.toFixed(1)} كم`;
            } 
            // إذا كان لديه مسافة محفوظة من حساب سابق
            else if (taxi.cachedNetworkDistance) {
                distance = `🛣️ ${taxi.cachedNetworkDistance.toFixed(1)} كم`;
            } 
            // المسافة الهوائية مؤقتاً
            else {
    // احسب المسافة الواقعية من API وحدث التكسي
    getRoute(taxi.coordinates, userLocation).then(route => {
        if (route && route.distance) {
            taxi.cachedNetworkDistance = route.distance / 1000; // بالكيلومتر
            updateTaxiListWithStats(); // إعادة التحديث بعد الحصول على المسافة
        }
    });

    // مؤقتاً، عرض المسافة الهوائية
    distance = `✈️ ${euclideanDistance.toFixed(1)} كم`;
}

        }
        // ========== نهاية تعديل حساب المسافة ==========
        
        const isNearest = nearestTaxi && nearestTaxi.id === taxi.id;
        
        // ========== عرض الوقت المتبقي بدقة ==========
        let etaInfo = '';
        if (taxi.isMoving && taxi.remainingTime > 0 && taxi.status === 'في الطريق' && taxi.targetPoint && taxi.targetPoint === userLocation) {
            const minutes = Math.floor(taxi.remainingTime / 60);
            const seconds = Math.floor(taxi.remainingTime % 60);
            const euclideanDistance = calculateDistance(taxi.coordinates, userLocation);
            const progressPercent = taxi.totalDuration > 0 ? ((taxi.totalDuration - taxi.remainingTime) / taxi.totalDuration) * 100 : 0;
            const actualNetworkDistance = taxi.actualNetworkDistance || euclideanDistance;
            
            etaInfo = `
                <div class="eta-info" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px; border-radius: 12px; margin: 10px 0;">
                    
                    <div style="text-align: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; font-size: 18px;">🚕 ${taxi.name} في الطريق</h3>
                    </div>
                    
                    <!-- العد التنازلي -->
                    <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 10px; text-align: center; margin: 10px 0;">
                        <div style="font-size: 28px; font-weight: bold; font-family: monospace;">
                            ⏱️ ${minutes}:${seconds.toString().padStart(2, '0')}
                        </div>
                        <div style="font-size: 12px; opacity: 0.8;">دقائق : ثواني للوصول</div>
                    </div>
                    
                    <!-- شريط التقدم -->
                    <div style="margin: 10px 0;">
                        <div style="font-size: 12px; text-align: center; margin-bottom: 5px;">${progressPercent.toFixed(0)}% من المسار مكتمل</div>
                        <div style="background: rgba(255,255,255,0.3); height: 6px; border-radius: 3px;">
                            <div style="background: #1abc9c; height: 100%; width: ${progressPercent}%; border-radius: 3px; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                    
                    <!-- تفاصيل المسار -->
                    <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; font-size: 12px;">
                        <div style="margin: 3px 0;">🛣️ <strong>مسار الشوارع:</strong> ${actualNetworkDistance.toFixed(1)} كم</div>
                        <div style="margin: 3px 0;">✈️ <strong>مسافة هوائية:</strong> ${euclideanDistance.toFixed(1)} كم</div>
                        <div style="margin: 3px 0;">📈 <strong>الفرق:</strong> +${(actualNetworkDistance - euclideanDistance).toFixed(1)} كم عبر الطرق</div>
                       
                </div>
            `;
        }
        // ========== نهاية عرض الوقت المتبقي ==========
        
        let statusIcon = '';
        switch(taxi.status) {
            case 'متاح': statusIcon = '✅'; break;
            case 'في الطريق': statusIcon = '🚗'; break;
            case 'دورية': statusIcon = '🔄'; break;
            case 'وصل': statusIcon = '🎯'; break;
            default: statusIcon = '❓';
        }
        
        return `
            <div class="taxi-info ${isNearest ? 'nearest-taxi' : ''} ${taxi.isMoving ? 'taxi-moving' : ''}">
                <strong>${taxi.name}</strong>
                ${etaInfo}
                ${isNearest ? '<br><strong>🎯 الأقرب إليك</strong>' : ''}
                <br>الحالة: ${statusIcon} ${taxi.status}<br>
                المسافة: ${distance}
                ${taxi.isMoving ? '<br><span style="color: #e74c3c;">🚗 في الطريق</span>' : ''}
                <div class="taxi-controls">
                    <button class="btn" onclick="moveToLocation(${taxi.id})" ${taxi.isMoving ? 'disabled' : ''}>
                        ${taxi.isMoving ? '⏳ يتحرك' : '📍 اذهب إلي'}
                    </button>
                    <button class="btn" onclick="trackTaxi(${taxi.id})" style="background: #9b59b6;">
                        👁️ تتبع
                    </button>
                </div>
            </div>
        `;
    }).join('');
    
    taxiList.innerHTML = `
        <h4 style="margin-top: 15px; color: #2c3e50;">التكاسي المتاحة:</h4>
        ${statsHTML}
        ${taxiHTML}
    `;
}
        
        // تتبع تكسي معين
        function trackTaxi(taxiId) {
            const taxi = taxis.find(t => t.id === taxiId);
            if (!taxi) return;
            
            // التركيز على التكسي
            map.flyTo({
                center: taxi.coordinates,
                zoom: 15,
                duration: 2000
            });
            
            // إضافة دائرة حول التكسي
            const circleId = `circle-${taxi.id}`;
            
            // إزالة الدائرة السابقة إن وجدت
            if (map.getSource(circleId)) {
                map.removeLayer(circleId);
                map.removeSource(circleId);
            }
            
            map.addSource(circleId, {
                'type': 'geojson',
                'data': {
                    'type': 'Feature',
                    'properties': {},
                    'geometry': {
                        'type': 'Point',
                        'coordinates': taxi.coordinates
                    }
                }
            });
            
            map.addLayer({
                'id': circleId,
                'type': 'circle',
                'source': circleId,
                'paint': {
                    'circle-radius': 30,
                    'circle-color': taxi.color,
                    'circle-opacity': 0.3,
                    'circle-stroke-width': 2,
                    'circle-stroke-color': taxi.color
                }
            });
            
            // إزالة الدائرة بعد 3 ثوان
            setTimeout(() => {
                if (map.getSource(circleId)) {
                    map.removeLayer(circleId);
                    map.removeSource(circleId);
                }
            }, 3000);
            
            document.getElementById('status').innerHTML = 
                `<div class="status success">👁️ يتم تتبع ${taxi.name}</div>`;
        }
        
        // تحديث مستمر لموقع التكاسي المتحركة
        function updateMovingTaxis() {
            taxis.forEach(taxi => {
                if (taxi.isMoving && taxi.currentRoute) {
                    // تحديث موقع الدائرة إذا كانت موجودة
                    const circleId = `circle-${taxi.id}`;
                    if (map.getSource(circleId)) {
                        map.getSource(circleId).setData({
                            'type': 'Feature',
                            'properties': {},
                            'geometry': {
                                'type': 'Point',
                                'coordinates': taxi.coordinates
                            }
                        });
                    }
                }
            });
        }
        
        // عرض جميع التكاسي على الخريطة
        function showAllTaxis() {
            const bounds = new mapboxgl.LngLatBounds();
            
            taxis.forEach(taxi => {
                bounds.extend(taxi.coordinates);
            });
            
            if (userLocation) {
                bounds.extend(userLocation);
            }
            
            map.fitBounds(bounds, {
                padding: 80,
                duration: 2000
            });
            
            document.getElementById('status').innerHTML = 
                '<div class="status success"> يتم عرض جميع التكاسي</div>';
        }
        
        // تحديث الوقت الفعلي
        function startRealTimeUpdates() {
            setInterval(() => {
                updateMovingTaxis();
                // تحديث قائمة التكاسي كل 5 ثوان
                if (Math.random() < 0.2) { // 20% احتمالية كل ثانية = مرة كل 5 ثوان تقريباً
                    updateTaxiListWithStats();
                }
            }, 1000);
        }
        
        // إضافة أزرار إضافية
        function addExtraControls() {
            const controlPanel = document.querySelector('.control-panel');
            const extraButtons = `
                <button class="btn" onclick="showAllTaxis()" style="background: #8e44ad;">
                     عرض جميع التكاسي
                </button>
                
            `;
            
            // إضافة الأزرار قبل div الحالة
            const statusDiv = document.getElementById('status');
            statusDiv.insertAdjacentHTML('beforebegin', extraButtons);
        }
        
        // استدعاء طوارئ
        async function emergencyCall() {
            if (!userLocation) {
                alert('يرجى تحديد موقعك أولاً');
                return;
            }
            
            // العثور على أقرب تكسي متاح
            let closestTaxi = null;
            let minDistance = Infinity;
            
            taxis.forEach(taxi => {
                if (!taxi.isMoving) {
                    const distance = calculateDistance(userLocation, taxi.coordinates);
                    if (distance < minDistance) {
                        minDistance = distance;
                        closestTaxi = taxi;
                    }
                }
            });
            
            if (closestTaxi) {
                // إيقاف جميع التكاسي الأخرى
                taxis.forEach(taxi => {
                    if (taxi.id !== closestTaxi.id) {
                        // ========== إضافة: تنظيف المتغيرات الجديدة في الطوارئ ==========
                        if (taxi.updateInterval) {
                            clearInterval(taxi.updateInterval);
                        }
                        // ========== نهاية الإضافة ==========
                        taxi.isMoving = false;
                        taxi.status = 'متوقف';
                        taxi.currentRoute = null;
                    }
                });
                
                // إرسال أقرب تكسي فوراً
                await moveToLocation(closestTaxi.id);
                
                document.getElementById('status').innerHTML = 
                    `<div class="status error"> تم إرسال ${closestTaxi.name} لحالة الطوارئ!</div>`;
            } else {
                document.getElementById('status').innerHTML = 
                    '<div class="status error">❌ لا توجد تكاسي متاحة للطوارئ</div>';
            }
        }
        
        // تحديث updateTaxiList لاستخدام النسخة الجديدة
        updateTaxiList = updateTaxiListWithStats;
        
        // إضافة مؤثرات صوتية (اختيارية)
        function playNotificationSound() {
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2u2pABCeFz/LOfSsFQdHy3J0tBTWN0fDkr3EAu6ER0NABAAAEAAACAAIAAQABAAAAAAABAAEAAACMxO3c3J4sO5zH7tuSRQ0DaK/l+7lqYAPHgPX3jTFfBfGt2dJ4DAgAQAA=');
                audio.volume = 0.1;
                audio.play();
            } catch (e) {
                // تجاهل أخطاء الصوت
            }
        }
        
        // تحميل الخريطة
map.on('load', function() {
    clipMapToBirzeit();
    updateEmergencyButton();
    addTaxisToMap();
    addPatrolPoints();
    addExtraControls();                clipMapToBirzeit();
updateEmergencyButton();

            addTaxisToMap();
            addPatrolPoints();
            addExtraControls();
            
            // إضافة أزرار التحكم
                addNetworkAnalysisButton();
    map.addControl(new mapboxgl.NavigationControl());

            map.addControl(new mapboxgl.NavigationControl());
            map.addControl(new mapboxgl.FullscreenControl());
            
            // بدء التحديثات الفورية
            startRealTimeUpdates();
            
            // تحديد الموقع تلقائياً
            findMyLocation();
            
            // رسالة ترحيب
            setTimeout(() => {
                document.getElementById('status').innerHTML = 
                    '<div class="status success">  تم تحديد الموقع بنجاح!</div>';
            }, 2000);
        });
        
       
       // إضافة هذه الدالة
function focusOnBirzeit() {
    const bounds = new mapboxgl.LngLatBounds();
    birzeitBoundary.features[0].geometry.coordinates[0].forEach(coord => {
        bounds.extend([coord[0], coord[1]]);
    });
    
    map.fitBounds(bounds, {
        padding: 20,
        duration: 1000
    });
} // ==================== تعديل: حفظ الإعدادات مع المتغيرات الجديدة ====================
        // حفظ الإعدادات في التخزين المحلي
        // دوال التحكم بالهاتف
        
function togglePanel() {
    if (window.innerWidth <= 480) {
        const panel = document.getElementById('controlPanel');
        panel.classList.toggle('expanded');
    }
}

function updateEmergencyButton() {
    const emergencyBtn = document.querySelector('.emergency-btn');
    if (window.innerWidth <= 480) {
        emergencyBtn.style.display = 'flex';
    } else {
        emergencyBtn.style.display = 'none';
    }
}

window.addEventListener('resize', updateEmergencyButton);
        function saveSettings() {
            const settings = {
                userLocation: userLocation,
                patrolMode: patrolMode
                // لا نحتاج لحفظ simulationSpeed لأننا نستخدم السرعة الحقيقية
            };
            try {
                // استخدام متغير عام بدلاً من localStorage
                window.appSettings = settings;
            } catch (e) {
                console.log('لا يمكن حفظ الإعدادات');
            }
        }
        
        // تحميل الإعدادات
        function loadSettings() {
            try {
                const settings = window.appSettings;
                if (settings) {
                    if (settings.userLocation) {
                        userLocation = settings.userLocation;
                    }
                    patrolMode = settings.patrolMode || false;
                    // لا نحتاج لتحميل simulationSpeed
                }
            } catch (e) {
                console.log('لا يمكن تحميل الإعدادات');
            }
        }
        // ==================== نهاية التعديل ====================
        
        // حفظ الإعدادات عند تغيير البيانات
        setInterval(saveSettings, 5000);
        
        // تحميل الإعدادات عند البدء
        loadSettings();
        
        // ==================== تعديل: تنظيف الموارد مع المتغيرات الجديدة ====================
        // تنظيف الموارد عند إغلاق النافذة
        window.addEventListener('beforeunload', function() {
            // ========== تعديل: تنظيف intervals الجديدة ==========
            taxis.forEach(taxi => {
                if (taxi.updateInterval) {
                    clearInterval(taxi.updateInterval);
                }
            });
            // كان: movementIntervals.forEach(interval => clearInterval(interval));
            // ========== نهاية التعديل ==========
            saveSettings();
        });
        // ==================== نهاية التعديل ====================
        
        // إضافة مؤثرات بصرية عند وصول التكسي
        function celebrateArrival(taxi) {
            // إضافة نجوم حول التكسي
            const starsCount = 8;
            for (let i = 0; i < starsCount; i++) {
                const angle = (i * 2 * Math.PI) / starsCount;
                const distance = 0.001; // مسافة صغيرة
                
                const starLng = taxi.coordinates[0] + Math.cos(angle) * distance;
                const starLat = taxi.coordinates[1] + Math.sin(angle) * distance;
                
                const starEl = document.createElement('div');
                starEl.innerHTML = '⭐';
                starEl.style.fontSize = '16px';
                
                const starMarker = new mapboxgl.Marker(starEl)
                    .setLngLat([starLng, starLat])
                    .addTo(map);
                
                // إزالة النجوم بعد 3 ثوان
                setTimeout(() => {
                    starMarker.remove();
                }, 3000);
            }
            
            // تشغيل صوت
            playNotificationSound();
        }
        // إضافة أزرار تحليل الشبكات
function addNetworkAnalysisButton() {
    const extraButtons = `
        <button class="btn" onclick="compareAllRoutesToUser()" style="background: #8e44ad;">
            📊 مقارنة جميع المسارات
        </button>
    `;
    
    document.getElementById('nearestBtn').insertAdjacentHTML('afterend', extraButtons);
}

// دالة مقارنة جميع المسارات (اختياري)
async function compareAllRoutesToUser() {
    if (!userLocation) {
        alert('يرجى تحديد موقعك أولاً');
        return;
    }
    
    document.getElementById('status').innerHTML = 
        '<div class="status loading">📊 جاري مقارنة جميع المسارات... <span class="loading-spinner"></span></div>';
    
    const availableTaxis = taxis.filter(t => t.status === 'متاح' && !t.isMoving);
    
    if (availableTaxis.length === 0) {
        document.getElementById('status').innerHTML = 
            '<div class="status error">❌ لا توجد تكاسي متاحة للمقارنة</div>';
        return;
    }
    
    const results = [];
    
    for (let taxi of availableTaxis) {
        // المسافة الهوائية
        const euclideanDist = calculateDistance(userLocation, taxi.coordinates);
        
        // المسار الفعلي عبر الشبكة
        const networkRoute = await getRoute(taxi.coordinates, userLocation);
        
        if (networkRoute) {
            results.push({
                name: taxi.name,
                euclidean: euclideanDist.toFixed(2),
                network: (networkRoute.distance / 1000).toFixed(2),
                time: Math.round(networkRoute.duration / 60)
            });
        }
        
        await new Promise(resolve => setTimeout(resolve, 300));
    }
    
    // ترتيب حسب الوقت
    results.sort((a, b) => a.time - b.time);
    
    // عرض النتائج
    const tableHTML = `
        <div style="background: #ffffff; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h4>📊 مقارنة المسارات</h4>
            ${results.map((result, index) => `
                <div style="margin: 8px 0; padding: 10px; border-radius: 5px; 
                           background: ${index === 0 ? '#d5f4e6' : '#f8f9fa'}; 
                           border-left: 3px solid ${index === 0 ? '#27ae60' : '#bdc3c7'};">
                    <strong>${result.name}</strong> ${index === 0 ? '🏆' : ''}
                    <br>📏 هوائي: ${result.euclidean} كم | شبكة: ${result.network} كم
                    <br>⏱️ وقت الوصول: <strong>${result.time} دقيقة</strong>
                </div>
            `).join('')}
        </div>
    `;
    
    document.getElementById('status').innerHTML = tableHTML;
}

    </script>
</body>
</html>